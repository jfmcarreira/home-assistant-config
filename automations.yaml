- alias: Desligar Tudo se a Casa Estiver Vazia
  id: '1651441102640'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.notify_home
    from: 'on'
    to: 'off'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  conditions:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  actions:
  - data: {}
    action: script.house_turn_all_off
  mode: single
- alias: Sincronizar Luzes do Hall
  id: '1652213927460'
  description: ''
  use_blueprint:
    path: lights/sync_lights.yaml
    input:
      master_light: light.hall
      slave_light: light.hall_side
      sync_exclusive: false
      sync_on: false
      sync_off: true
      sync_off_from_slave: true
- alias: Controlo da Luz da Despensa com a Porta
  id: '1653347146334'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.kitchen_pantry_door
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.kitchen_pantry_door
        state: 'on'
      sequence:
      - service: light.turn_on
        data: {}
        target:
          entity_id: light.kitchen_pantry
    default:
    - service: light.turn_off
      data: {}
      target:
        entity_id: light.kitchen_pantry
  mode: single
- alias: Lights Turn On Exterior With Kitchen Door
  id: '1653354558079'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.kitchen_door
    from: 'off'
    to: 'on'
  condition:
  - condition: state
    entity_id: light.exterior_wall_back
    state: 'off'
  - condition: state
    entity_id: binary_sensor.sun_bellow_horizont
    state: 'on'
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id: light.exterior_wall_back
  - wait_for_trigger:
    - platform: state
      entity_id:
      - binary_sensor.kitchen_door
      to: 'off'
    - platform: state
      entity_id:
      - light.exterior_wall_back
      to: 'off'
  - condition: state
    entity_id: light.kitchen_door
    state: 'on'
  - wait_for_trigger:
    - platform: state
      entity_id:
      - light.exterior_wall_back
      to: 'off'
    timeout: 00:01:00
  - condition: state
    entity_id: light.exterior_wall_back
    state: 'on'
  - service: light.turn_off
    data: {}
    target:
      entity_id:
      - light.exterior_wall_back
  mode: single
- alias: Lights Turn On Kitchen Light
  id: '1653947527310'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.kitchen_door
    from: 'off'
    to: 'on'
  condition:
  - condition: numeric_state
    entity_id: sun.sun
    attribute: elevation
    below: '5'
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id: light.kitchen_led
  mode: single
- alias: Tarefa Máquina de Lavar Roupa
  id: '1655079401495'
  description: ''
  use_blueprint:
    path: tasks/machine_two_steps_task.yaml
    input:
      machine_sensor: binary_sensor.washing_machine_state
      machine_door_sensor: binary_sensor.washing_machine_door
      machine_energy_sensor: sensor.device_energy_washing_machine
      task_needs_attention: binary_sensor.wash_machine_wet_clothes
      task_done_door_time: 0
      task_machine_code_name: Washing_Machine_Wash_Clothes
      task_done_code_name: Washing_Machine_Clothes_Off
      machine_finish_message: A máquina da roupa terminou. Pode retirar a roupa
      send_notification: false
      notification_action: Roupa Retirada
      android_task_id: 20
      notification_action_id: washing_machine_clothes_off
- alias: Tarefa do Filtro da Água
  id: '1655462775855'
  description: ''
  use_blueprint:
    path: tasks/tracked_tasks.yaml
    input:
      task_needs_attention: binary_sensor.water_filter_needs_replacement
      task_sensor: sensor.water_filter_replacement_last_done
      task_done_code_name: Water_Filter_Replacement
      send_notification: true
      notification_max_time: '21:00:00'
      notification_message: O Filtro da Água Necessita de Substuição
      notification_action: Filtro Substituido
      android_task_id: 30
      notification_action_id: water_filter_replaced
- alias: Tarefa da Máquina de Secar
  id: '1655496730769'
  description: ''
  use_blueprint:
    path: tasks/machine_two_steps_task.yaml
    input:
      machine_sensor: binary_sensor.dryer_machine_state
      machine_door_sensor: binary_sensor.dryer_machine_door
      machine_energy_sensor: sensor.device_energy_dryer_machine
      task_needs_attention: binary_sensor.dryer_machine_need_emtpy
      task_machine_code_name: Dryer_Machine_Clean
      task_done_code_name: Dryer_Machine_Empty
      machine_finish_message: Máquina de Secar Terminou. Pode Retirar a Roupa!
      notification_action: Roupa Retirada
      send_notification: false
      android_task_id: 21
      notification_action_id: dryer_machine_clothes_off
      task_done_door_time: 0
- alias: Sincronizar Luzes da Cozinha
  id: '1656374052136'
  description: ''
  use_blueprint:
    path: lights/sync_lights.yaml
    input:
      master_light: light.kitchen_led
      slave_light: light.kitchen_window
      sync_exclusive: false
      sync_on: false
      sync_off: true
      sync_off_from_slave: true
- alias: Controlar Luz da Sala Day/Night
  id: '1657064426365'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.living_room_window
    from: 'off'
    to: 'on'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.night_mode
        state: 'on'
      sequence:
      - service: scene.turn_on
        target:
          entity_id: scene.lights_living_room_night
        metadata: {}
    default:
    - service: scene.turn_on
      target:
        entity_id: scene.lights_living_room_day
      metadata: {}
  mode: single
- alias: Luzes por Mov. nas Escadas
  id: '1657408193240'
  description: ''
  use_blueprint:
    path: lights/motion_based_lights_v3.yaml
    input:
      motion_sensor: binary_sensor.motion_sensor_stairs
      target_entity: light.stairs_wall
      no_motion_wait: 30
      illuminance_sensor: sensor.light_stairs
      illuminance_cutoff: 50
      only_after_sunset: false
      disable_in_guest: false
      blocker_on_entity: light.stairs_group
      required_house_mode: Dia+Anoitecer
      room_name: Stairs
      disable_in_sleep: true
      presence_sensor: none
- id: '1657981029516'
  alias: Activar Rotina de Chegar a Casa
  description: ''
  triggers:
  - id: joao_trigger
    entity_id:
    - binary_sensor.joao_home
    from: 'off'
    to: 'on'
    trigger: state
  - id: bianca_trigger
    entity_id:
    - binary_sensor.bianca_home
    from: 'off'
    to: 'on'
    trigger: state
  - id: car_trigger
    entity_id:
    - binary_sensor.front_camera_car
    - binary_sensor.backyard_camera_car
    - binary_sensor.front_camera_reolink_vehicle
    - binary_sensor.backyard_camera_reolink_vehicle
    from: 'off'
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.sun_bellow_horizont
    state: 'on'
  - condition: or
    conditions:
    - condition: and
      conditions:
      - condition: template
        value_template: '{{ trigger.id == ''car_trigger'' }}'
      - condition: or
        conditions:
        - condition: state
          entity_id: binary_sensor.joao_home_with_hysteresis
          state: 'off'
        - condition: state
          entity_id: binary_sensor.bianca_home_with_hysteresis
          state: 'off'
    - condition: and
      conditions:
      - condition: state
        entity_id: binary_sensor.joao_home_with_hysteresis
        state: 'off'
      - condition: template
        value_template: '{{ trigger.id == ''joao_trigger'' }}'
    - condition: and
      conditions:
      - condition: state
        entity_id: binary_sensor.bianca_home_with_hysteresis
        state: 'off'
      - condition: template
        value_template: '{{ trigger.id == ''bianca_trigger'' }}'
  actions:
  - data: {}
    action: script.lights_arriving_home
  mode: restart
- alias: Controlar Luz da Cozinha Day/Night
  id: '1658004941042'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.kitchen_led
    from: 'off'
    to: 'on'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.night_mode
        state: 'on'
      sequence:
      - service: scene.turn_on
        target:
          entity_id: scene.lights_kitchen_night
        metadata: {}
    default:
    - service: scene.turn_on
      target:
        entity_id: scene.lights_kitchen_day
      metadata: {}
  mode: single
- alias: Tarefa da Máquina de Lavar a Loiça
  id: '1658177571375'
  description: ''
  use_blueprint:
    path: tasks/machine_two_steps_task.yaml
    input:
      machine_sensor: binary_sensor.dish_wash_machine_state
      machine_door_sensor: binary_sensor.dish_wash_machine_door
      machine_energy_sensor: sensor.device_energy_dish_wash_machine
      task_needs_attention: binary_sensor.dish_wash_machine_clean
      task_machine_code_name: Dish_Wash_Clean
      task_done_code_name: Dish_Wash_Empty
      machine_finish_message: A máquina de lavar loiça terminou. Pode retirar a loiça
      android_task_id: 22
      send_notification: true
      notification_action: Loiça Retirada
      notification_action_id: task_dish_wash_empty
      task_done_door_time: 2
- alias: cctv control push notifications
  id: '1658672750916'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.notify_home
    - binary_sensor.house_guest
    - sensor.house_mode
  condition: []
  action:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: state
          entity_id: binary_sensor.notify_home
          state: 'on'
        - condition: state
          entity_id: binary_sensor.house_guest
          state: 'on'
      sequence:
      - service: switch.turn_off
        data: {}
        target:
          entity_id:
          - switch.backyard_camera_push_notifications
          - switch.front_camera_push_notifications
    default:
    - service: switch.turn_on
      data: {}
      target:
        entity_id:
        - switch.backyard_camera_push_notifications
        - switch.front_camera_push_notifications
  mode: single
- id: '1658675704141'
  alias: Notificar Deteção Câmara da Frente
  description: ''
  use_blueprint:
    path: cameras/send-camera-snapshot-notification-on-motion.yaml
    input:
      notification_title: Segurança - Câmara da Frente
      notification_message: Pessoas ou Carros Detectados na Câmara da Frente
      notify_joao: true
      camera: camera.front
      motion_sensor:
      - binary_sensor.front_camera_smart_detection
      notify_bianca: false
      notification_tag: cctv_front_snapshot
- id: '1658676096110'
  alias: Notificar Deteção Câmara das Traseiras
  description: ''
  use_blueprint:
    path: cameras/send-camera-snapshot-notification-on-motion.yaml
    input:
      notification_title: Segurança - Câmara das Traseiras
      notification_message: Pessoas ou Carros Detectados na Câmara das Traseiras
      notify_joao: true
      camera: camera.backyard
      motion_sensor:
      - binary_sensor.backyard_camera_smart_detection
      notify_bianca: false
      notification_tag: cctv_backyard_snapshot
- alias: 'Desligar Luzes da Despensa com Temporizador '
  id: '1659187275200'
  description: ''
  triggers:
  - type: turned_on
    device_id: 157313d13fb325a54a0135d57c4b348d
    entity_id: light.kitchen_pantry
    domain: light
    for:
      hours: 0
      minutes: 30
      seconds: 0
    trigger: device
  conditions:
  - condition: state
    entity_id: binary_sensor.motion_sensor_kitchen
    state: 'off'
    for:
      hours: 0
      minutes: 2
      seconds: 0
  actions:
  - type: turn_off
    device_id: 157313d13fb325a54a0135d57c4b348d
    entity_id: light.kitchen_pantry
    domain: light
  mode: single
- alias: Fechar Estores Fachada Poente
  id: '1661088354800'
  description: ''
  triggers:
  - entity_id:
    - sensor.temperature_outside
    for:
      hours: 0
      minutes: 15
      seconds: 0
    above: 25
    trigger: numeric_state
  - entity_id:
    - sun.sun
    for:
      hours: 0
      minutes: 0
      seconds: 0
    above: 180
    attribute: azimuth
    trigger: numeric_state
  - entity_id: sun.sun
    for:
      hours: 0
      minutes: 30
      seconds: 0
    above: 180
    attribute: azimuth
    trigger: numeric_state
  - entity_id:
    - sun.sun
    for:
      hours: 1
      minutes: 0
      seconds: 0
    above: 180
    attribute: azimuth
    trigger: numeric_state
  - trigger: state
    entity_id:
    - binary_sensor.notify_home
    to: 'off'
    from: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  conditions:
  - condition: numeric_state
    entity_id: sensor.temperature_outside
    above: 25
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  - condition: numeric_state
    entity_id: sun.sun
    attribute: azimuth
    above: 179
  - condition: state
    entity_id: binary_sensor.house_guest
    state: 'off'
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  actions:
  - data:
      action_to_run: cover.close_cover
      control_switch: close_with_heat
      covers_list:
      - master_bedroom
      - kitchen
    action: script.cover_group_action
  mode: single
- alias: Abrir Estores da Suite Fim de Semana
  id: '1661120403152'
  description: ''
  trigger:
  - platform: time_pattern
    hours: '10'
    minutes: '00'
  condition:
  - condition: state
    entity_id: binary_sensor.workday
    state: 'off'
  - condition: state
    entity_id: cover.master_bedroom
    state: closed
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  action:
  - service: cover.open_cover
    data: {}
    target:
      entity_id: cover.master_bedroom
  mode: single
- alias: Fechar Estores Fachada Sul
  id: '1661196402455'
  description: ''
  triggers:
  - hours: '10'
    minutes: '00'
    seconds: '00'
    trigger: time_pattern
  - hours: '10'
    minutes: '30'
    seconds: '00'
    trigger: time_pattern
  - entity_id: sensor.temperature_outside
    for:
      hours: 0
      minutes: 30
      seconds: 0
    above: 23
    trigger: numeric_state
  - trigger: state
    entity_id:
    - binary_sensor.notify_home
    to: 'off'
    from: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  conditions:
  - condition: numeric_state
    entity_id: sensor.temperature_outside
    above: 25
  - condition: time
    after: '10:00:00'
    before: '16:00:00'
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  - condition: state
    entity_id: binary_sensor.house_guest
    state: 'off'
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  actions:
  - data:
      action_to_run: cover.close_cover
      control_switch: close_with_heat
      covers_list:
      - stairs
      - bedroom_rc
      - laundry
    action: script.cover_group_action
  mode: single
- alias: Luzes por Mov. no Escritório
  id: '1661643560066'
  description: ''
  use_blueprint:
    path: lights/motion_based_lights_v3.yaml
    input:
      motion_sensor: binary_sensor.motion_sensor_office
      target_entity: light.office
      min_repetition_interval_sec: 10
      illuminance_sensor: sensor.light_office
      illuminance_cutoff: 10
      only_after_sunset: false
      disable_in_guest: false
      required_house_mode: Todos
      room_name: Escritório
      blocker_on_entity: light.office
      disable_in_sleep: true
      presence_sensor: none
      no_motion_wait: 10
      disable_switch_button: button.shelly25_lights_office_auto_on
- alias: Trigger Botões da Cama da Suite
  id: '1665241197738'
  description: ''
  triggers:
  - device_id: 0917b5ae15c6e0fb6aa33f8f6a9fc492
    domain: shelly
    type: long_push
    subtype: button1
    id: first_long
    trigger: device
  - device_id: 0917b5ae15c6e0fb6aa33f8f6a9fc492
    domain: shelly
    type: long_push
    subtype: button2
    id: second_long
    trigger: device
  - device_id: 0917b5ae15c6e0fb6aa33f8f6a9fc492
    domain: shelly
    type: single_push
    subtype: button1
    id: first_short
    trigger: device
  - device_id: 0917b5ae15c6e0fb6aa33f8f6a9fc492
    domain: shelly
    type: single_push
    subtype: button2
    id: second_short
    trigger: device
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: trigger
          id: first_long
        - condition: trigger
          id: second_long
      sequence:
      - if:
        - condition: state
          state: 'off'
          entity_id:
          - light.master_bedroom
          - light.master_bedroom_bathroom
          - light.hall_group
          - light.stairs_group
        then:
        - data: {}
          target:
            entity_id:
            - light.master_bedroom
          action: light.turn_on
        else:
        - data: {}
          target:
            area_id:
            - hall
            - bathroom_main
            - master_bedroom_bathroom
            - master_bedroom
          action: light.turn_off
      alias: Long Press
    - conditions:
      - condition: or
        conditions:
        - condition: trigger
          id: first_short
      sequence:
      - data: {}
        target:
          entity_id: light.master_bedroom_bed_window
        action: light.toggle
      alias: Left Short
    - conditions:
      - condition: or
        conditions:
        - condition: trigger
          id: second_short
      sequence:
      - data: {}
        target:
          entity_id: light.master_bedroom_bed_wall
        action: light.toggle
      alias: Right Short
  mode: single
- alias: Desligar Coluna do Hall com as Luzes
  id: '1668971106955'
  description: ''
  triggers:
  - entity_id:
    - light.hall_group
    from: 'on'
    to: 'off'
    trigger: state
  conditions: []
  actions:
  - data: {}
    target:
      entity_id: media_player.ghm_hall
    action: media_player.turn_off
  mode: single
- id: Lights Xmas Auto On
  alias: Ligar Luzes da Arvore de Natal Tarde
  description: ''
  triggers:
  - entity_id: binary_sensor.notify_home
    to: 'on'
    trigger: state
  - trigger: numeric_state
    entity_id:
    - sensor.sun_solar_elevation
    below: 15
  conditions:
  - condition: template
    value_template: '{{ state_attr("sun.sun", "elevation") < 15 }}'
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'on'
  - condition: time
    after: '16:00:00'
    before: '23:30'
  actions:
  - entity_id: light.xmas_tree
    action: light.turn_on
  mode: restart
- id: Lights Xmas Auto Off
  alias: Desligar Luzes de Natal
  triggers:
  - at: 02:00:00
    trigger: time
  actions:
  - data: {}
    entity_id: light.xmas_tree
    action: light.turn_off
  mode: restart
- id: '1669853123196'
  alias: Luzes por Mov. na Cozinha
  description: ''
  use_blueprint:
    path: lights/motion_based_lights_v3.yaml
    input:
      motion_sensor: binary_sensor.motion_sensor_kitchen
      target_entity: light.kitchen
      min_repetition_interval_sec: 10
      illuminance_sensor: sensor.light_living_room
      illuminance_cutoff: 50
      only_after_sunset: 'off'
      disable_in_guest: true
      required_house_mode: Todos
      room_name: Escritório
      blocker_on_entity: light.kitchen
      disable_in_sleep: true
      presence_sensor: none
      no_motion_wait: 30
- alias: Termoventilador - Desligar Automáticamente
  id: '1669853572469'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.main_bathroom
    from: 'on'
    to: 'off'
    id: lights_off_main
  - platform: state
    entity_id:
    - light.master_bedroom_bathroom
    from: 'on'
    to: 'off'
    id: lights_off_master
  - platform: state
    entity_id:
    - switch.portable_heater
    to: 'on'
    for:
      hours: 1
      minutes: 0
      seconds: 0
    id: timeout
  condition:
  - condition: or
    conditions:
    - condition: and
      conditions:
      - condition: state
        entity_id: input_select.portable_heater_location
        state: Casa de Banho Principal
      - condition: trigger
        id:
        - lights_off_main
    - condition: and
      conditions:
      - condition: state
        entity_id: input_select.portable_heater_location
        state: Casa de Banho da Suite
      - condition: trigger
        id:
        - lights_off_master
    - condition: trigger
      id:
      - timeout
  action:
  - service: climate.turn_off
    data: {}
    target:
      entity_id: climate.portable_heater
  - service: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.portable_heater
  mode: single
- alias: device_toggle_portable_heater_bathroom_main_light_switch
  id: '1669853950698'
  description: ''
  trigger:
  - platform: event
    event_type: esphome.button_pressed
    event_data:
      name: button_2
      type: long
      device: shelly25_bathroom_main
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: climate.portable_heater
        state: 'off'
      sequence:
      - service: climate.turn_on
        data: {}
        target:
          entity_id: climate.portable_heater
    default:
    - service: climate.turn_off
      data: {}
      target:
        entity_id: climate.portable_heater
  mode: single
- id: '1670373784711'
  alias: Xmas Lights Outside
  description: ''
  triggers:
  - trigger: sun
    event: sunset
  - trigger: time
    at: '16:01:00'
  - trigger: time
    at: 03:01:00
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: time
          after: '16:00:00'
          before: 03:00:00
        - condition: sun
          after: sunset
      sequence:
      - action: light.turn_on
        metadata: {}
        target:
          entity_id: light.xmas_outside
        data: {}
    default:
    - action: light.turn_off
      metadata: {}
      target:
        entity_id: light.xmas_outside
      data: {}
  mode: restart
- alias: Desligar Luzes das Escadas com a Luminosidade
  id: '1670674527026'
  description: ''
  triggers:
  - entity_id: sensor.light_stairs
    for:
      hours: 0
      minutes: 5
      seconds: 0
    above: 60
    trigger: numeric_state
  - entity_id:
    - light.stairs_group
    to: 'on'
    for:
      hours: 0
      minutes: 5
      seconds: 0
    trigger: state
  conditions:
  - condition: numeric_state
    entity_id: sensor.light_stairs
    above: 50
  - condition: state
    entity_id: light.stairs_group
    state: ''
  actions:
  - data: {}
    target:
      entity_id:
      - light.stairs_lamp
      - light.stairs_wall
      - light.stairs_down
      - light.stairs_group
    action: light.turn_off
  mode: single
- alias: cctv_control_recording
  id: '1673206351942'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.notify_home
    - binary_sensor.house_guest
    - sensor.house_mode
  condition: []
  action:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: and
          conditions:
          - condition: state
            entity_id: binary_sensor.notify_home
            state: 'on'
          - condition: time
            after: 09:00:00
            before: '22:00:00'
        - condition: state
          entity_id: binary_sensor.house_guest
          state: 'on'
      sequence:
      - service: switch.turn_off
        data: {}
        target:
          entity_id:
          - switch.front_camera_record
          - switch.backyard_camera_record
    default:
    - service: switch.turn_on
      data: {}
      target:
        entity_id:
        - switch.front_camera_record
        - switch.backyard_camera_record
  mode: single
- alias: Deshumidificador - Desligar Automáticamente
  id: '1675112824745'
  description: ''
  triggers:
  - entity_id:
    - switch.dehumidifier
    to: 'on'
    for:
      hours: 2
      minutes: 0
      seconds: 0
    trigger: state
  - at: '23:00:00'
    trigger: time
  - at: 00:30:00
    trigger: time
  conditions: []
  actions:
  - data: {}
    target:
      entity_id: humidifier.portable_dehumidifier
    action: humidifier.turn_off
  - data: {}
    target:
      entity_id: switch.dehumidifier
    action: switch.turn_off
  mode: single
- alias: Deshumidificador - Ligar Automáticamente Manhã
  id: '1678915034155'
  description: ''
  triggers:
  - at: 07:15:00
    trigger: time
  conditions:
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  actions:
  - data: {}
    target:
      entity_id: humidifier.portable_dehumidifier
    action: humidifier.turn_on
  mode: single
- alias: Luzes por Mov. na Sala
  id: '1683763190674'
  description: ''
  use_blueprint:
    path: lights/motion_based_lights_v3.yaml
    input:
      motion_sensor: binary_sensor.motion_sensor_stairs_hallway
      target_entity: light.hallway_presence
      min_repetition_interval_sec: 10
      illuminance_sensor: sensor.light_living_room
      illuminance_cutoff: 10
      only_after_sunset: false
      disable_in_guest: true
      required_house_mode: Todos
      room_name: Sala
      disable_in_sleep: true
      presence_sensor: none
      required_conditions:
      - condition: state
        entity_id: light.hallway
        state: 'off'
      - condition: state
        entity_id: light.doorway
        state: 'off'
      - condition: state
        entity_id: light.hallway
        state: 'off'
      - condition: state
        entity_id: light.living_room_group
        state: 'off'
      - condition: state
        entity_id: light.stairs_down
        state: 'off'
- alias: Abrir Parcialmente Estores Noite do Primeiro Andar
  id: '1689453293699'
  description: ''
  triggers:
  - event: sunset
    offset: 00:05:00
    trigger: sun
  conditions:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  actions:
  - data: {}
    target:
      entity_id:
      - cover.bedroom_ricardo
      - cover.master_bedroom
      - cover.bedroom_henrique
    action: cover.close_cover
  - data:
      position: 25
    target:
      entity_id:
      - cover.master_bedroom
      - cover.bedroom_ricardo
      - cover.bedroom_henrique
    action: cover.set_cover_position
  mode: single
- alias: lights turn on with gate
  id: '1692141921133'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - cover.gate
    to: opening
  condition: []
  action:
  - condition: state
    entity_id: binary_sensor.sun_bellow_horizont
    state: 'on'
  - service: light.turn_on
    data: {}
    target:
      entity_id: light.exterior_wall_side
  - delay:
      hours: 0
      minutes: 0
      seconds: 30
      milliseconds: 0
  - wait_for_trigger:
    - platform: state
      entity_id:
      - cover.gate
      to: closed
    timeout:
      hours: 0
      minutes: 20
      seconds: 0
      milliseconds: 0
  - condition: state
    entity_id: script.lights_arriving_home
    state: 'off'
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.exterior_wall_side
  mode: single
- alias: device_alert_fridge_power
  id: '1696123178186'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.device_power_fridge
    below: 10
    for:
      hours: 2
      minutes: 0
      seconds: 0
  condition: []
  action:
  - service: notify.mobile_app_all
    data:
      title: Equipamentos
      message: O frigorifico está desligado à mais de 1 hora!
      data:
        tag: '1000'
        priority: high
        persistent: false
        channel: Home
        sticky: false
        clickAction: /lovelace-subviews/dashboard-power
  mode: single
- alias: lights_trigger_hallway_presence
  id: '1696606664632'
  description: ''
  triggers:
  - device_id: 65801262e841d379b0b0b71f3ff22624
    domain: shelly
    type: long_push
    subtype: button2
    trigger: device
  conditions: []
  actions:
  - target:
      entity_id: light.hallway_presence
    data: {}
    action: light.toggle
  mode: single
- alias: Sincronizar Luzes do Corredor
  id: '1696606723356'
  description: ''
  use_blueprint:
    path: lights/sync_lights.yaml
    input:
      master_light: light.hallway
      slave_light: light.hallway_presence
      sync_exclusive: true
      sync_on: false
      sync_off: true
      sync_off_from_slave: false
- alias: Comutar Deshumidificador Casa de Banho da Suite
  id: '1696716423195'
  description: ''
  trigger:
  - platform: event
    event_type: esphome.button_pressed
    event_data:
      name: button_2
      type: long
      device: shelly25_bathroom_suite
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: humidifier.portable_dehumidifier
        state: 'off'
      sequence:
      - service: switch.turn_on
        data: {}
        target:
          entity_id: switch.dehumidifier
      - delay:
          hours: 0
          minutes: 0
          seconds: 10
          milliseconds: 0
      - service: humidifier.turn_on
        data: {}
        target:
          entity_id: humidifier.portable_dehumidifier
    default:
    - service: humidifier.turn_off
      data: {}
      target:
        entity_id: humidifier.portable_dehumidifier
    - service: switch.turn_off
      data: {}
      target:
        entity_id: switch.dehumidifier
  mode: single
- alias: hvac_adjust_dehumidifier_target
  id: '1696854410563'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.humidity_outside_average
    to:
  condition:
  - condition: template
    value_template: '{% set difference = states(''sensor.humidity_outside_average'')
      | float - state_attr(''humidifier.portable_dehumidifier'', ''humidity'') %}
      {{ is_number(difference) and difference | float > 5 }}'
  action:
  - service: humidifier.set_humidity
    data:
      humidity: '{{ states(''sensor.humidity_outside_average'') }}'
    target:
      entity_id: humidifier.portable_dehumidifier
  mode: single
- alias: Água Quente - Desligar Noite
  id: '1699195635629'
  description: ''
  trigger:
  - platform: time
    at: '23:45:00'
  condition: []
  action:
  - service: climate.turn_off
    data: {}
    target:
      entity_id: climate.water_heater
  mode: single
- alias: AC Desligar Auto - Manhã
  id: '1699342762120'
  description: ''
  triggers:
  - at: 09:00:00
    trigger: time
  conditions:
  - condition: state
    entity_id: binary_sensor.workday
    state: 'on'
  actions:
  - data: {}
    target:
      entity_id:
      - climate.living_room
      - climate.master_bedroom
      - climate.office
      - climate.bedroom_ricardo
      - climate.bedroom_henrique
      - climate.hall
      - climate.portable_heater
    action: climate.turn_off
  mode: single
- alias: 'Desligar Luzes da Rua com Temporizador '
  id: '1699840344840'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.kitchen_door
    - light.gate_lights
    - light.exterior_wall_side
    - light.exterior_wall_back
    - light.exterior_wall_east
    - light.front_door
    from:
    to:
  condition:
  - condition: state
    entity_id: binary_sensor.house_guest
    state: 'off'
  action:
  - delay:
      hours: 1
      minutes: 0
      seconds: 0
      milliseconds: 0
  - condition: state
    entity_id: binary_sensor.house_guest
    state: 'off'
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.outside_group
  mode: restart
- id: '1701482615616'
  alias: Ligar Luzes da Árvore de Natal de Manhã
  description: ''
  triggers:
  - at: 07:00:00
    trigger: time
  conditions:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'on'
  actions:
  - target:
      entity_id: light.xmas_tree
    data: {}
    action: light.turn_on
  mode: single
- alias: 'Controlar Luz das Escadas Day/Night '
  id: '1701541427434'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.stairs_down
    from: 'off'
    to: 'on'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.night_mode
        state: 'on'
      sequence:
      - service: scene.turn_on
        target:
          entity_id: scene.lights_stairs_night
        metadata: {}
    default:
    - service: scene.turn_on
      target:
        entity_id: scene.lights_stairs_day
      metadata: {}
  mode: single
- alias: Luzes por Mov. na Lavandaria
  id: '1701730252666'
  description: ''
  use_blueprint:
    path: lights/motion_based_lights_v3.yaml
    input:
      motion_sensor: binary_sensor.motion_sensor_laundry
      target_entity: light.laundry
      min_repetition_interval_sec: 10
      illuminance_sensor: sensor.light_laundry
      illuminance_cutoff: 70
      only_after_sunset: false
      disable_in_guest: true
      required_house_mode: Todos
      room_name: Lavandaria
      blocker_on_entity: light.laundry
      disable_in_sleep: true
      presence_sensor: none
      disable_switch_button: button.shelly25_lights_laundry_auto_on
- alias: Máq. Lavar Loica - Alertar para iniciar
  id: '1702942175908'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.dish_wash_machine_state
    from: 'off'
    to: 'on'
  condition: []
  action:
  - service: input_boolean.turn_off
    target:
      entity_id: input_boolean.reminder_dish_washing_machine
    data: {}
  mode: single
- alias: AC Quartos - Desligar Noite
  id: '1704843402395'
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_off.yaml
    input:
      schedule: 01:00:00
      hvac_unit:
      - climate.master_bedroom
      - climate.bedroom_henrique
      - climate.bedroom_ricardo
      run_on_weekends: true
- alias: Alertar UPS activa
  id: '1705111890973'
  description: ''
  triggers:
  - entity_id:
    - sensor.salicru_rack_ups_status
    from: OL
    for:
      hours: 0
      minutes: 0
      seconds: 5
    trigger: state
  conditions: []
  actions:
  - data:
      title: Equipamentos
      message: A UPS está em modo de bateria à mais de 30 segundos
      channel: Home
    action: notify.mobile_app_radium
  - if:
    - condition: state
      entity_id: binary_sensor.joao_mac_book_active_home
      state: 'on'
    then:
    - data:
        title: Equipamentos
        message: A UPS está em modo de bateria à mais de 30 segundos
        channel: Home
      action: notify.mobile_app_joaocarreira_macbook_pro
  mode: single
- id: '1705326979364'
  alias: AC Sala - Desligar Manhã
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_off.yaml
    input:
      schedule: 08:30:00
      hvac_unit: climate.living_room
      run_on_weekends: false
      weekend_tomorrow: false
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
- alias: AC Sala - Desligar Noite
  id: '1705327069565'
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_off.yaml
    input:
      schedule: 03:00:00
      hvac_unit:
      - climate.living_room
      run_on_weekends: true
      weekend_tomorrow: false
- id: '1707834041529'
  alias: Abrir Estores da Suite
  description: ''
  triggers:
  - hours: '7'
    minutes: '45'
    trigger: time_pattern
  conditions:
  - condition: state
    entity_id: binary_sensor.workday
    state: 'on'
  - condition: state
    entity_id: cover.master_bedroom
    state: closed
  - condition: state
    entity_id: input_boolean.day_off_work
    state: 'off'
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  actions:
  - data: {}
    target:
      entity_id: cover.master_bedroom
    action: cover.open_cover
  mode: single
- alias: Tablet Control Motion Detection Living Room
  id: '1658360353381'
  description: ''
  triggers:
  - entity_id:
    - input_select.house_mode
    - binary_sensor.notify_home
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: state
          entity_id: sensor.house_mode
          state: 'Off'
        - condition: state
          entity_id: sensor.house_mode
          state: Sleep
        - condition: state
          entity_id: binary_sensor.notify_home
          state: 'off'
      sequence:
      - action: switch.turn_off
        data: {}
        target:
          entity_id:
          - switch.lenovo_tablet_motion_detection
      - action: switch.turn_off
        data: {}
        target:
          entity_id:
          - switch.lenovo_tablet_screen
    default:
    - data: {}
      target:
        entity_id:
        - switch.lenovo_tablet_motion_detection
      action: switch.turn_on
  mode: queued
- alias: Tablet Screen Timeout Living Room
  id: '1708474653467'
  description: ''
  triggers:
  - entity_id:
    - input_select.house_mode
    trigger: state
  conditions: []
  actions:
  - if:
    - or:
      - condition: state
        entity_id: input_select.house_mode
        state: 'On'
      - condition: state
        entity_id: input_select.house_mode
        state: Evening
      - condition: state
        entity_id: input_select.house_mode
        state: Night
    then:
    - target:
        entity_id:
        - number.lenovo_tablet_screen_off_timer
      data:
        value: '0'
      action: number.set_value
    - type: turn_on
      device_id: 070256d058f9215d8c746c4242331023
      entity_id: b856d2fd4dd80e2b1d02e391c347fc75
      domain: switch
    else:
    - target:
        entity_id:
        - number.lenovo_tablet_screen_off_timer
      data:
        value: '120'
      action: number.set_value
  mode: single
- alias: Fechar Parcialment Estores de Manhã/Tarde
  id: '1689293787806'
  description: ''
  trigger:
  - platform: time
    at: '11:00:00'
  - platform: time
    at: '18:00:00'
  condition: []
  action:
  - service: script.cover_group_action
    data:
      action_to_run: script.cover_partial_close
      control_switch: open_sunrise
      covers_list:
      - living_room
      - stairs
      - bedroom_henrique
      - bedroom_ricardo
      - master_bedroom
      - bathroom
      - bedroom_rc
      - laundry
      - kitchen
      - office
  mode: single
- alias: Abrir Parcialmente Estores à Tarde
  id: '1689293902907'
  description: ''
  trigger:
  - platform: time
    at: '11:30:00'
  condition: []
  action:
  - service: script.cover_group_action
    data:
      action_to_run: script.cover_partial_open
      control_switch: open_sunrise
      covers_list:
      - living_room
      - stairs
      - bedroom_henrique
      - bedroom_ricardo
      - master_bedroom
      - bathroom
      - bedroom_rc
      - laundry
      - kitchen
      - office
  mode: single
- alias: Abrir Estores ao Nascer do Sol
  id: '1652141596083'
  description: ''
  triggers:
  - event: sunrise
    offset: 00:30:00
    trigger: sun
  - at: 08:01:00
    trigger: time
  conditions:
  - condition: time
    after: 08:00:00
    before: '12:00:00'
  - condition: numeric_state
    entity_id: sun.sun
    attribute: elevation
    above: '0'
  - condition: template
    value_template: '{{ now().timestamp() - (this.attributes.last_triggered | as_timestamp
      | int(0)) > 60 * 60 *18 }}'
  - condition: state
    entity_id: binary_sensor.workday
    state: 'on'
  actions:
  - data:
      action_to_run: script.cover_open_if_close
      control_switch: open_sunrise
      covers_list:
      - living_room
      - stairs
      - bedroom_henrique
      - bedroom_ricardo
      - master_bedroom
      - bathroom
      - bedroom_rc
      - laundry
      - kitchen
      - office
    action: script.cover_group_action
  mode: single
- alias: Fechar Estores quando chove
  id: '1663526552935'
  description: ''
  mode: single
  trigger:
  - platform: numeric_state
    entity_id: weather.home
    attribute: precipitation_unit
    above: 70
  condition:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  action:
  - service: script.cover_group_action
    data:
      action_to_run: script.cover_close_when_raining
      control_switch: close_in_rain
      covers_list:
      - living_room
      - stairs
      - bedroom_henrique
      - bedroom_ricardo
      - master_bedroom
      - bathroom
      - bedroom_rc
      - laundry
      - kitchen
      - office
- alias: Fechar Estores ao Por do Sol
  id: '1651018838807'
  description: ''
  triggers:
  - event: sunset
    offset: 00:00:00
    trigger: sun
  - event: sunset
    offset: '1:00:00'
    trigger: sun
  - trigger: time
    at: '20:00:00'
  - trigger: time
    at: '21:00:00'
  - trigger: time
    at: '22:00:00'
  - trigger: time
    at: '23:00:00'
  conditions:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  - condition: template
    value_template: '{% set hours = 12 %} {% set last = state_attr(this.entity_id,
      ''last_triggered'') %} {{ last is not none and (now() - last).total_seconds()
      > hours * 3600 }}

      '
  - condition: sun
    after: sunset
  actions:
  - data:
      action_to_run: cover.close_cover
      control_switch: close_sunset
      covers_list:
      - living_room
      - stairs
      - bedroom_henrique
      - bedroom_ricardo
      - master_bedroom
      - bathroom
      - bedroom_rc
      - laundry
      - kitchen
      - office
    action: script.cover_group_action
  mode: single
- id: '1703619934344'
  alias: AC Sala - Ajustar durante a refeição
  triggers:
  - entity_id:
    - light.living_room_table
    from:
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 10
    trigger: state
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: climate.living_room
      state: cool
    - condition: state
      entity_id: climate.living_room
      state: heat
  actions:
  - target:
      entity_id: climate.living_room
    data:
      fan_mode: quiet
    action: climate.set_fan_mode
  - wait_for_trigger:
    - entity_id:
      - light.living_room_table
      from: 'on'
      to: 'off'
      for:
        hours: 0
        minutes: 0
        seconds: 10
      trigger: state
    timeout:
      hours: 1
      minutes: 45
      seconds: 0
      milliseconds: 0
  - target:
      entity_id: climate.living_room
    data:
      fan_mode: auto
    action: climate.set_fan_mode
  mode: single
- alias: Água Quente - Ligar Manhã
  id: '1665435183140'
  description: ''
  triggers:
  - at: 06:01:00
    trigger: time
  - entity_id:
    - binary_sensor.water_heater_panel_heating
    to: 'off'
    for:
      hours: 0
      minutes: 15
      seconds: 0
    trigger: state
  - entity_id:
    - sensor.temperature_water_heater_top
    below: 50
    trigger: numeric_state
  conditions:
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  - condition: time
    after: 06:00:00
    before: '12:00:00'
  actions:
  - condition: state
    entity_id: binary_sensor.water_heater_panel_heating
    state: 'off'
  - condition: numeric_state
    entity_id:
    - sensor.temperature_water_heater_top
    below: 50
  - data: {}
    target:
      entity_id: climate.water_heater
    action: climate.turn_on
  mode: single
- alias: Água Quente - Desligar Manhã
  id: '1665435233424'
  description: ''
  triggers:
  - at: 08:30:00
    trigger: time
  - at: 09:30:00
    trigger: time
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: weather.home
      state: sunny
    - condition: and
      conditions:
      - condition: state
        entity_id: binary_sensor.workday
        state: 'on'
      - condition: state
        entity_id: input_boolean.day_off_work
        state: 'off'
    - condition: state
      entity_id: binary_sensor.water_heater_panel_heating
      state: 'on'
    - condition: numeric_state
      entity_id: sensor.temperature_water_heater_top
      above: 50
  actions:
  - data: {}
    target:
      entity_id: climate.water_heater
    action: climate.turn_off
  mode: single
- alias: Água Quente - Ligar Tarde
  id: '1665435448806'
  description: ''
  triggers:
  - event: sunset
    offset: -01:00:00
    trigger: sun
  - at:
    - '15:00:00'
    - '16:00:00'
    - '17:00:00'
    - '18:00:00'
    - '19:00:00'
    - '20:00:00'
    - '21:00:00'
    trigger: time
  - entity_id: binary_sensor.water_heater_panel_heating
    from: 'on'
    to: 'off'
    for:
      minutes: 30
    trigger: state
  conditions:
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  - condition: time
    after: '15:00:00'
    before: '22:00:00'
  - condition: state
    entity_id: binary_sensor.water_heater_panel_heating
    state: 'off'
    for:
      minutes: 10
  - condition: template
    value_template: '{{ now().timestamp() - (this.attributes.last_triggered | as_timestamp
      | int(0)) > 60 * 60 * 12 }}'
  - condition: numeric_state
    entity_id: sensor.temperature_water_heater_top
    below: 60
  actions:
  - data: {}
    target:
      entity_id: climate.water_heater
    action: climate.turn_on
  mode: single
- alias: Água Quente - Desligar Presets
  id: '1674085777289'
  description: ''
  triggers:
  - at: '22:30:00'
    trigger: time
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: climate.water_heater
      attribute: preset_mode
      state: none
  actions:
  - data:
      preset_mode: none
    target:
      entity_id: climate.water_heater
    action: climate.set_preset_mode
  mode: single
- alias: Água Quente - Modo Conforto Manhã
  id: turn_on_confort_mode_weekens
  description: ''
  trigger:
  - platform: time
    at: '10:30:00'
  - platform: state
    entity_id:
    - binary_sensor.water_heater_panel_heating
    to: 'off'
    for:
      hours: 0
      minutes: 15
      seconds: 0
  - platform: numeric_state
    entity_id:
    - sensor.temperature_water_heater_top
    below: 50
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.workday
      state: 'off'
    - condition: state
      entity_id: input_boolean.day_off_work
      state: 'on'
  - condition: not
    conditions:
    - condition: state
      entity_id: weather.home
      state: sunny
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'on'
  - condition: state
    entity_id: binary_sensor.water_heater_pump_state
    state: 'off'
  - condition: numeric_state
    entity_id: sensor.temperature_water_heater_bottom
    below: 30
  - condition: state
    entity_id: binary_sensor.water_heater_panel_heating
    state: 'off'
  action:
  - condition: state
    entity_id: binary_sensor.water_heater_panel_heating
    state: 'off'
  - condition: numeric_state
    entity_id:
    - sensor.temperature_water_heater_top
    below: 50
  - service: climate.turn_on
    data: {}
    target:
      entity_id: climate.water_heater
  - service: climate.set_preset_mode
    data:
      preset_mode: comfort
    target:
      entity_id: climate.water_heater
  mode: single
- id: '1701641659897'
  alias: Atualizar Localização
  triggers:
  - entity_id:
    - binary_sensor.backyard_camera_person
    - binary_sensor.backyard_camera_car
    - binary_sensor.front_camera_car
    - binary_sensor.front_camera_person
    - binary_sensor.backyard_camera_reolink_person
    - binary_sensor.backyard_camera_reolink_vehicle
    - binary_sensor.front_camera_reolink_vehicle
    - binary_sensor.front_camera_reolink_person
    from: 'off'
    to: 'on'
    trigger: state
  - entity_id:
    - cover.gate
    to: opening
    trigger: state
  - entity_id:
    - cover.gate
    to: open
    trigger: state
  conditions: []
  actions:
  - repeat:
      while:
      - condition: state
        entity_id: binary_sensor.joao_home
        state: 'off'
      - condition: state
        entity_id: binary_sensor.bianca_home
        state: 'off'
      - condition: template
        value_template: '{{ repeat.index <= 5 }}'
      sequence:
      - parallel:
        - action: script.gps_update_joao
          data: {}
        - action: script.gps_update_bianca
          data: {}
      - delay:
          hours: 0
          minutes: 0
          seconds: 10
          milliseconds: 0
  trace:
    stored_traces: 40
  mode: restart
- alias: Abrir Portão João Chegar a Casa
  id: '1701986636577'
  description: ''
  triggers:
  - entity_id:
    - sensor.distance_home_joao
    for:
      hours: 0
      minutes: 0
      seconds: 2
    below: 200
    trigger: numeric_state
  - entity_id:
    - binary_sensor.joao_home
    from: 'off'
    to: 'on'
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.joao_home_with_hysteresis
    state: 'off'
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.joao_home
      state: 'on'
    - condition: and
      conditions:
      - condition: numeric_state
        entity_id: sensor.distance_home_joao
        below: 300
      - condition: state
        entity_id: sensor.distance_home_direction_joao
        state: towards
  - condition: state
    entity_id: input_boolean.walking_routine
    state: 'off'
  - condition: state
    entity_id: cover.gate
    state: closed
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - condition: state
    entity_id: input_boolean.gate_automatic_open
    state: 'on'
  actions:
  - target:
      entity_id: cover.gate
    data: {}
    action: cover.open_cover
  - data: {}
    action: script.lights_arriving_home
  mode: single
- alias: Localização - Atualizar Joao
  id: '1701640659897'
  triggers:
  - trigger: time_pattern
    seconds: /5
  conditions:
  - condition: state
    entity_id: binary_sensor.joao_home
    state: 'off'
  - condition: state
    state: towards
    entity_id: sensor.distance_home_direction_joao
  - condition: numeric_state
    entity_id: sensor.distance_home_joao
    below: 2000
  - condition: state
    entity_id: input_boolean.walking_routine
    state: 'off'
  actions:
  - action: script.gps_update_joao
    data: {}
  trace:
    stored_traces: 40
  mode: single
- alias: Localização - Atualizar Bianca
  id: '1701986497262'
  triggers:
  - trigger: time_pattern
    seconds: /5
  conditions:
  - condition: state
    entity_id: binary_sensor.bianca_home
    state: 'off'
  - condition: state
    state: towards
    entity_id: sensor.distance_home_direction_bianca
  - condition: numeric_state
    entity_id: sensor.distance_home_bianca
    below: 1000
  - condition: state
    entity_id: input_boolean.walking_routine
    state: 'off'
  actions:
  - action: script.gps_update_bianca
    data: {}
  trace:
    stored_traces: 40
  mode: single
- alias: Tarefa de Substituição da Areia das Gatas
  id: '1709598685655'
  description: ''
  use_blueprint:
    path: tasks/tracked_tasks.yaml
    input:
      task_needs_attention: binary_sensor.cat_litter_box_need_change
      task_sensor: sensor.cat_litter_box_last_change
      task_done_code_name: Cat_Litter_Change
      send_notification: true
      notification_max_time: '19:00:00'
      notification_message: A Areia das Gatas Necessita de Substituição
      notification_action: Registar Substituição
      android_task_id: 31
      notification_action_id: cat_litter_change
- alias: Tarefa de Limpeza da Areia das Gatas
  id: '1709598896541'
  description: ''
  use_blueprint:
    path: tasks/tracked_tasks.yaml
    input:
      task_needs_attention: binary_sensor.cat_litter_box_need_clean
      task_sensor: sensor.cat_litter_box_last_clean
      task_done_code_name: Cat_Litter_Clean
      send_notification: false
      notification_max_time: 00:00:00
      notification_message: A Areia das Gatas Necessita de Limpeza
      notification_action: Registar Limpeza
      android_task_id: 32
      notification_action_id: cat_litter_clean
- id: '1709743628443'
  alias: Alertar Portão Aberto com a Casa Vazia
  description: ''
  triggers:
  - id: trigger_gate_open
    entity_id:
    - cover.gate
    to:
    - open
    for:
      hours: 0
      minutes: 5
      seconds: 0
    trigger: state
  - id: trigger_gate_close
    entity_id:
    - cover.gate
    to: close
    trigger: state
  - id: trigger_house_empty
    entity_id:
    - binary_sensor.notify_home
    to:
    - 'off'
    for:
      hours: 0
      minutes: 5
      seconds: 0
    trigger: state
  - id: trigger_notification_gate_notification_action_close
    event_type: mobile_app_notification_action
    event_data:
      action: gate_notification_action_close
    trigger: event
  - id: trigger_notification_gate_notification_action_keep_open
    event_type: mobile_app_notification_action
    event_data:
      action: gate_notification_action_keep_open
    trigger: event
  conditions: []
  actions:
  - alias: Se Acção é Fechar Portão
    if:
    - condition: trigger
      id:
      - trigger_notification_gate_notification_action_close
    then:
    - condition: state
      entity_id: cover.gate
      state: open
    - data: {}
      target:
        entity_id: cover.gate
      action: cover.close_cover
    - stop: Portão fechado
  - if:
    - condition: trigger
      id:
      - trigger_notification_gate_notification_action_keep_open
    then:
    - delay:
        hours: 0
        minutes: 10
        seconds: 0
        milliseconds: 0
    alias: Se Acção é Deixar Aberto
  - condition: state
    entity_id: cover.gate
    state: open
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  - data:
      title: Exterior
      message: O Portão da Rua está Aberto
      data:
        tag: '300'
        priority: high
        persistent: true
        sticky: true
        channel: Segurança
        clickAction: /lovelace-subviews/dashboard-exterior
        actions:
        - action: gate_notification_action_keep_open
          title: Deixar Aberto
        - action: gate_notification_action_close
          title: Fechar o Portao
    action: notify.mobile_app_radium
  mode: restart
- alias: Alertar Alarme Joao Dias de Trabalho
  id: '1711849617966'
  description: ''
  trigger:
  - platform: time
    at: '23:00:00'
  - platform: time
    at: '23:30:00'
  - platform: time
    at: 00:00:00
  - platform: time
    at: 00:30:00
  - platform: time
    at: 01:00:00
  - platform: time
    at: 01:30:00
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: sensor.radium_next_alarm
      state: unknown
    - condition: state
      entity_id: sensor.radium_next_alarm
      state: unavailable
    alias: Radium Without Alarm
  - condition: or
    conditions:
    - condition: and
      conditions:
      - condition: time
        after: 00:00:00
        before: 07:00:00
      - condition: state
        entity_id: binary_sensor.workday
        state: 'on'
    - condition: and
      conditions:
      - condition: time
        after: 07:00:00
        before: 00:00:00
      - condition: state
        entity_id: binary_sensor.workday_tomorrow
        state: 'on'
  - condition: state
    entity_id: input_boolean.day_off_work
    state: 'off'
  action:
  - service: notify.mobile_app_radium
    data:
      title: Routinas
      message: Deve configurar o alarme para amanhã!
      data:
        tag: 923
  mode: single
- alias: Controlar Luzes do Portão
  id: '1716079775767'
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.gate_close
    to: 'off'
    trigger: state
    from: 'on'
  conditions: []
  actions:
  - data: {}
    action: script.lights_control_gate_front_lights
  mode: single
- id: '1716575201372'
  alias: Campainha - Accionar campainha portão
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.gate_bell_button
    from:
    to: 'on'
    trigger: state
  conditions: []
  actions:
  - parallel:
    - action: script.turn_on
      target:
        entity_id: script.gate_display_front_camera_tablet
    - action: script.turn_on
      target:
        entity_id: script.gate_notify_door_bell_snapshot
    - if:
      - condition: state
        entity_id: binary_sensor.notify_home
        state: 'on'
      - condition: state
        entity_id: binary_sensor.notification_non_disturb
        state: 'off'
      - condition: state
        entity_id: input_boolean.door_bell_sound
        state: 'on'
      then:
      - action: media_player.volume_set
        target:
          entity_id:
          - media_player.ghm_living_room
          - media_player.ghm_kitchen
        data:
          volume_level: 0.005
      - repeat:
          for_each:
          - media_player.ghm_living_room
          - media_player.ghm_kitchen
          sequence:
          - action: tts.cloud_say
            data:
              cache: true
              entity_id: '{{ repeat.item }}'
              message: This is a broadcast message
      - action: media_player.volume_set
        target:
          entity_id:
          - media_player.ghm_living_room
          - media_player.ghm_kitchen
        data:
          volume_level: 0.7
      - target:
          entity_id:
          - media_player.home_assistant_voice_office
          - media_player.ghm_living_room
          - media_player.ghm_kitchen
        data:
          media:
            media_content_id: media-source://media_source/local/door_bell.wav
            media_content_type: audio/x-wav
            metadata:
              title: Door Bell
              thumbnail:
              media_class: music
              children_media_class:
              navigateIds:
              - {}
              - media_content_type: app
                media_content_id: media-source://media_source
        action: media_player.play_media
      - if:
        - condition: time
          after: 09:00:00
          before: '21:00:00'
        - condition: numeric_state
          entity_id: cover.bedroom_henrique
          attribute: current_position
          above: 0
        then:
        - action: media_player.volume_set
          target:
            entity_id:
            - media_player.ghm_hall
          data:
            volume_level: 0.005
        - action: tts.cloud_say
          data:
            cache: true
            entity_id: media_player.ghm_hall
            message: This is a broadcast message
        - action: media_player.volume_set
          target:
            entity_id:
            - media_player.ghm_hall
          data:
            volume_level: 0.7
        - target:
            entity_id:
            - media_player.ghm_hall
          data:
            media:
              media_content_id: media-source://media_source/local/door_bell.wav
              media_content_type: audio/x-wav
              metadata:
                title: Door Bell
                thumbnail:
                media_class: music
                children_media_class:
                navigateIds:
                - {}
                - media_content_type: app
                  media_content_id: media-source://media_source
          action: media_player.play_media
    - action: camera.snapshot
      entity_id: camera.front
      data:
        filename: /media/Campainha/{{now().year}}-{{"%02d" | format(now().month)}}-{{"%02d"
          | format(now().day)}}_{{"%02d" | format(now().hour)}}h{{"%02d" | format(now().minute)}}.jpg
  mode: single
- alias: 'Notificar Abertura Portão/Portas '
  id: '1717504841456'
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.front_door
    - binary_sensor.kitchen_door
    from: 'off'
    to: 'on'
    trigger: state
    for:
      hours: 0
      minutes: 0
      seconds: 5
  - entity_id:
    - cover.gate
    from: closed
    to: opening
    trigger: state
    for:
      hours: 0
      minutes: 1
      seconds: 0
  conditions:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  actions:
  - data:
      message: '{{ trigger.to_state.attributes.friendly_name }} foi aberta!'
      title: Segurança
      data:
        tag: '1201'
        priority: high
        channel: Segurança
        clickAction: /lovelace-subviews/dashboard-house
    action: notify.mobile_app_all
  mode: single
- alias: Desligar Modo de Férias
  id: '1717852934831'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.notify_home
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition:
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'on'
    for:
      hours: 8
      minutes: 0
      seconds: 0
  action:
  - service: input_boolean.turn_off
    target:
      entity_id: input_boolean.extended_away_mode
    data: {}
  mode: single
- alias: Localização - Atualizar com base nas pessoas
  id: '1717889364762'
  trace:
    stored_traces: 40
  description: ''
  trigger:
  - platform: state
    entity_id:
    - person.bianca_pires
    to: not_home
    from: home
  - platform: state
    entity_id:
    - person.bianca_pires
    to: not_home
    from: home
    for:
      hours: 0
      minutes: 0
      seconds: 5
  - platform: state
    entity_id:
    - person.bianca_pires
    from:
    to: home
  - platform: state
    entity_id:
    - person.joao_carreira
    to: not_home
    from: home
  - platform: state
    entity_id:
    - person.joao_carreira
    from:
    to: home
  - platform: state
    entity_id:
    - person.joao_carreira
    to: not_home
    from: home
    for:
      hours: 0
      minutes: 0
      seconds: 5
  condition: []
  action:
  - action: script.gps_update_joao
  - action: script.gps_update_bianca
  mode: single
- alias: Abrir Portão Bianca Chegar a Casa
  id: '1721089640569'
  description: ''
  triggers:
  - entity_id:
    - sensor.distance_home_bianca
    for:
      hours: 0
      minutes: 0
      seconds: 2
    below: 200
    trigger: numeric_state
  - entity_id:
    - binary_sensor.bianca_home
    from: 'off'
    to: 'on'
    trigger: state
  conditions:
  - condition: state
    entity_id: binary_sensor.bianca_home_with_hysteresis
    state: 'off'
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.bianca_home
      state: 'on'
    - condition: and
      conditions:
      - condition: numeric_state
        entity_id: sensor.distance_home_bianca
        below: 300
      - condition: state
        entity_id: sensor.distance_home_direction_bianca
        state: towards
  - condition: state
    entity_id: input_boolean.walking_routine
    state: 'off'
  - condition: state
    entity_id: cover.gate
    state: closed
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - condition: state
    entity_id: input_boolean.gate_automatic_open
    state: 'on'
  actions:
  - target:
      entity_id: cover.gate
    data: {}
    action: cover.open_cover
  - data: {}
    action: script.lights_arriving_home
  mode: single
- alias: Abrir Estores ao Nascer do Sol - Modo de Férias
  id: '1723197292654'
  description: ''
  trigger:
  - platform: sun
    event: sunrise
    offset: 00:30:00
  condition:
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'on'
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  action:
  - service: cover.open_cover
    metadata: {}
    data: {}
    target:
      label_id: covers
  mode: single
- alias: Fechar Estores ao Por do Sol - Modo de Férias
  id: '1723197551703'
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: 00:00:00
  condition:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'on'
  action:
  - service: cover.close_cover
    metadata: {}
    data: {}
    target:
      label_id: covers
  - service: cover.set_cover_position
    metadata: {}
    data:
      position: 30
    target:
      floor_id: bedrooms
  - service: cover.set_cover_position
    metadata: {}
    data:
      position: 15
    target:
      entity_id: cover.laundry
  mode: single
- alias: Ar Condicionado - Notificar Janelas Abertas Quartos
  id: '1723936636115'
  description: ''
  triggers:
  - entity_id:
    - climate.master_bedroom
    - climate.bedroom_ricardo
    - climate.bedroom_henrique
    - climate.hall
    to:
    for:
      hours: 0
      minutes: 5
      seconds: 0
    from:
    trigger: state
  - entity_id:
    - binary_sensor.window_main_bathroom
    - binary_sensor.window_master_bedroom
    - binary_sensor.window_bedroom_ricardo
    - binary_sensor.window_bedroom_henrique
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 10
      seconds: 0
    trigger: state
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: climate.hall
      state: cool
    - condition: state
      entity_id: climate.master_bedroom
      state: cool
    - condition: state
      entity_id: climate.bedroom_ricardo
      state: cool
    - condition: state
      entity_id: climate.bedroom_henrique
      state: cool
    - condition: state
      entity_id: climate.hall
      state: heat
    - condition: state
      entity_id: climate.master_bedroom
      state: heat
    - condition: state
      entity_id: climate.bedroom_ricardo
      state: heat
    - condition: state
      entity_id: climate.bedroom_henrique
      state: heat
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.window_main_bathroom
      state: 'on'
    - condition: state
      entity_id: binary_sensor.window_bedroom_henrique
      state: 'on'
    - condition: state
      entity_id: binary_sensor.window_master_bedroom
      state: 'on'
    - condition: state
      entity_id: binary_sensor.window_bedroom_ricardo
      state: 'on'
  actions:
  - data:
      title: Equipamentos
      message: Ar Condicionado Ligado nos Quartos com Janelas Abertas
      data:
        priority: high
        persistent: false
        channel: Home
        sticky: false
        clickAction: /lovelace-subviews/dashboard-ac
    action: notify.mobile_app_all
  mode: single
- alias: Ar Condicionado - Notificar Janelas Abertas Sala
  id: '1723937695759'
  description: ''
  triggers:
  - entity_id:
    - climate.living_room
    - climate.office
    to:
    for:
      hours: 0
      minutes: 1
      seconds: 0
    from:
    trigger: state
  - entity_id:
    - binary_sensor.window_laundry
    - cover.living_room
    - binary_sensor.kitchen_door
    - binary_sensor.front_door
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 10
      seconds: 0
    trigger: state
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: climate.living_room
      state: cool
    - condition: state
      entity_id: climate.office
      state: cool
    - condition: state
      entity_id: climate.living_room
      state: heat
    - condition: state
      entity_id: climate.office
      state: heat
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.window_laundry
      state: 'on'
    - condition: state
      entity_id: binary_sensor.window_living_room
      state: 'on'
  actions:
  - data:
      title: Equipamentos
      message: Ar Condicionado Ligado no R/C com Janelas Abertas
      data:
        priority: high
        persistent: false
        channel: Home
        sticky: false
        clickAction: /lovelace-subviews/dashboard-ac
    action: notify.mobile_app_all
  mode: single
- alias: lights_turn_on_kitchen_led_switch
  id: '1724277480761'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.kitchen_led
    to: unavailable
    for:
      hours: 0
      minutes: 0
      seconds: 30
  condition:
  - condition: state
    entity_id: switch.kitchen_led_sw
    state: 'off'
  action:
  - action: switch.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: switch.kitchen_led_sw
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.kitchen_led
  mode: single
- alias: Modo Caminhada - Desligar Automaticamente
  id: '1724363986092'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - lock.gate_door
    from: locked
    to: unlocked
  - platform: state
    entity_id:
    - cover.gate
    from: closed
    to: opening
  - platform: state
    entity_id:
    - binary_sensor.kitchen_door
    from: 'off'
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.walking_routine
    state: 'on'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  action:
  - action: input_boolean.turn_off
    target:
      entity_id: input_boolean.walking_routine
    data: {}
  mode: single
- alias: Modo Caminhada - Terminar
  id: '1724364138858'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.walking_routine
    from: 'on'
    to: 'off'
  condition: []
  action:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.gate_lights
      - light.exterior_wall_side
      - light.exterior_wall_back
  mode: single
- alias: Modo de Caminhada - Iniciar
  id: '1724364182177'
  description: ''
  triggers:
  - entity_id:
    - input_boolean.walking_routine
    from: 'off'
    to: 'on'
    trigger: state
  conditions: []
  actions:
  - condition: state
    entity_id: binary_sensor.sun_bellow_horizont
    state: 'on'
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.gate_lights
      - light.exterior_wall_side
      - light.exterior_wall_back
  mode: single
- alias: Tarefa da Vitamina D
  id: '1724969557801'
  description: ''
  triggers:
  - id: trigger_send_notification
    minutes: '0'
    trigger: time_pattern
    hours: '2'
  - id: trigger_send_notification_time
    at: '11:00:00'
    trigger: time
  - id: trigger_mark_done
    event_type: mobile_app_notification_action
    event_data:
      action: task_vitamin_d_mark_done
    trigger: event
  - id: trigger_dismiss
    at: '20:00:00'
    trigger: time
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ trigger.id == ''trigger_send_notification'' or trigger.id
          == ''trigger_send_notification_time'' }}'
      sequence:
      - condition: time
        after: '11:00:00'
        before: '15:00:00'
      - condition: state
        entity_id: binary_sensor.task_vitamin_d
        state: 'on'
      - repeat:
          for_each:
          - person: person.joao_carreira
            device: notify.mobile_app_radium
          - person: person.bianca_pires
            device: notify.mobile_app_calcium
          sequence:
          - if:
            - condition: template
              value_template: '{{ is_state(repeat.item.person, ''home'') }}'
            then:
            - data:
                title: Saúde
                message: Administrar Vitamina D ao Henrique
                data:
                  tag: 800
                  priority: high
                  persistent: false
                  channel: Tasks
                  sticky: true
                  clickAction: /lovelace-subviews/dashboard-shores
                  actions:
                  - action: task_vitamin_d_mark_done
                    title: Marcar como realizado
              action: '{{ repeat.item.device }}'
    - conditions:
      - condition: template
        value_template: '{{ trigger.id == ''trigger_dismiss'' }}'
      sequence:
      - data:
          message: clear_notification
          data:
            tag: 800
            dismiss: true
        action: notify.mobile_app_all
    default:
    - data:
        message: clear_notification
        data:
          tag: 800
          dismiss: true
      action: notify.mobile_app_all
    - condition: state
      entity_id: binary_sensor.task_vitamin_d
      state: 'on'
    - data:
        table: tasks
        value: Henrique_Vitamin_D
        column: task_name
        date_stamp: '"{{ now().timestamp() | timestamp_custom("%Y-%m-%d %H:%M:%S")
          }}"

          '
        save_string: 'true'
        save_date_time: 'true'
      action: shell_command.external_my_sql_insert
- alias: Sincronizar Luzes da Rua
  id: '1727984098644'
  description: ''
  use_blueprint:
    path: lights/sync_lights.yaml
    input:
      master_light: light.kitchen_door
      slave_light: light.outside_group
      sync_exclusive: false
      sync_on: false
      sync_off_from_slave: false
      sync_off: true
- alias: Localização - Sincronizar Dispositivos João
  id: '1728490959918'
  description: ''
  use_blueprint:
    path: location/sync_device_location.yaml
    input:
      mobile_device: 2a682060bb472236a68fdd3ff33a221a
      wifi_location: device_tracker.radium_wifi
      mobile_location: device_tracker.radium
- alias: Localização - Sincronizar Dispositivos Bianca
  id: '1728491015669'
  description: ''
  use_blueprint:
    path: location/sync_device_location.yaml
    input:
      mobile_device: 086fd6ff05201d28b4bc0fbdbd707c86
      wifi_location: device_tracker.calcium_wifi
      mobile_location: device_tracker.calcium
- id: '1729990082630'
  alias: Luzes por Mov. Casa de Banho de Serviço
  description: ''
  use_blueprint:
    path: lights/motion_based_lights_v3.yaml
    input:
      motion_sensor: binary_sensor.motion_sensor_bathroom_rc
      target_entity: light.bathroom_rc_led
      disable_switch_button: button.shelly_2pm_gen3_bathroom_rc_trigger_automatic_on
      min_repetition_interval_sec: 10
      only_after_sunset: false
      disable_in_guest: false
      required_house_mode: Todos
      room_name: Casa de Banho de Serviço
      blocker_on_entity: light.bathroom_rc
      disable_in_sleep: true
      presence_sensor: none
      no_motion_wait: 10
      illuminance_cutoff: 75
      illuminance_sensor: none
- alias: Trigger Abrir Cancela
  id: '1731973582356'
  description: ''
  triggers:
  - device_id: c19fefbddb20592f460908bcdb303d5d
    domain: shelly
    type: long_push
    subtype: button1
    trigger: device
  conditions: []
  actions:
  - action: lock.unlock
    metadata: {}
    data: {}
    target:
      entity_id: lock.gate_door
  mode: single
- alias: Trigger Botão da Luz da Porta da Cozinha
  id: '1732671997843'
  description: ''
  use_blueprint:
    path: devices/shelly_one_button.yaml
    input:
      device: 26c8a6c331839dece04f2bf801d991d9
      button_short: []
      button_long:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id:
          - light.kitchen_door
          - light.exterior_wall_side
          - light.exterior_wall_back
- alias: Trigger Botões dos Estores da Casa de Banho do R/C
  id: '1735221054299'
  description: ''
  use_blueprint:
    path: devices/bhonofre_cover_buttons.yaml
    input:
      device: bhonofre_cover_bathroom_rc
      single_top_action:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bathroom_rc_led
      single_bottom_action:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.bathroom_rc_led
      triple_top_action:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bathroom_rc_ceiling
      triple_bottom_action:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.bathroom_rc_ceiling
- alias: task_trigger_change_cat_litter
  id: '1735385296449'
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Mudar a Areia das Gatas
    - Substituir a Areia das Gatas
  conditions: []
  actions:
  - action: automation.trigger
    metadata: {}
    data:
      skip_condition: true
    target:
      entity_id: automation.task_cat_litter_change
  mode: single
- alias: Desligar Coluna da Casa de Banho Principal com as Luzes
  id: '1735500742595'
  description: ''
  triggers:
  - entity_id:
    - light.main_bathroom
    from: 'on'
    to: 'off'
    trigger: state
  conditions: []
  actions:
  - data: {}
    action: media_player.turn_off
    target:
      entity_id: media_player.ghm_main_bathroom
  mode: single
- alias: Trigger Botões dos Estores da Cozinha
  id: '1736718854079'
  description: ''
  use_blueprint:
    path: devices/bhonofre_cover_buttons.yaml
    input:
      device: bhonofre_cover_kitchen
      single_top_action:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.kitchen_pantry
      single_bottom_action:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.kitchen_pantry
- alias: Trigger Botões dos Estores do Quarto do Ricardo
  id: '1736719479439'
  description: ''
  use_blueprint:
    path: devices/bhonofre_cover_buttons.yaml
    input:
      device: bhonofre_cover_bedroom_ricardo
      main_double_top_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: script.hvac_turn_on_bedroom_ricardo
      main_double_bottom_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: climate.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: climate.bedroom_ricardo
      single_top_action:
      - action: light.turn_on
        data: {}
        target:
          entity_id: light.bedroom_ricardo_lamp
      single_bottom_action:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_ricardo_lamp
      double_top_action:
      - action: script.hvac_turn_on_bedroom_ricardo
      double_bottom_action:
      - action: climate.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: climate.bedroom_ricardo
      triple_top_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: '{{ state_attr(''climate.bedroom_ricardo'', ''temperature'')
            + 1 }}'
        target:
          entity_id: climate.bedroom_ricardo
      triple_bottom_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: '{{ state_attr(''climate.bedroom_ricardo'', ''temperature'')
            - 1 }}'
        target:
          entity_id: climate.bedroom_ricardo
      long_top_action:
      - device_id: c7002942ba7f47c421aa7f13dfe25821
        domain: light
        entity_id: f9fd747a176070ae121da1a9d423245f
        type: brightness_increase
      long_bottom_action:
      - device_id: c7002942ba7f47c421aa7f13dfe25821
        domain: light
        entity_id: f9fd747a176070ae121da1a9d423245f
        type: brightness_decrease
- alias: Desumidificador - Ligar com a Tomada
  id: '1736764669175'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - switch.dehumidifier
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 10
  conditions:
  - condition: state
    entity_id: humidifier.portable_dehumidifier
    state: 'off'
  actions:
  - action: humidifier.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: humidifier.portable_dehumidifier
  mode: single
- alias: Ajustar Volume dos Assistentes
  id: '1736788353807'
  description: ''
  triggers:
  - event: start
    trigger: homeassistant
  - entity_id: input_number.assistant_volume_day
    trigger: state
  - entity_id: input_number.assistant_volume_evening
    trigger: state
  - entity_id: input_number.assistant_volume_night
    trigger: state
  - minutes: 30
    trigger: time_pattern
  - at: 08:00:00
    trigger: time
  - at: '21:00:00'
    trigger: time
  - at: 00:00:00
    trigger: time
  conditions: []
  actions:
  - repeat:
      for_each:
      - media_player.ghm_kitchen
      - media_player.ghm_living_room
      - media_player.ghm_hall
      - media_player.ghm_master_bedroom
      - media_player.ghm_main_bathroom
      - media_player.home_assistant_voice_office
      sequence:
      - condition: template
        value_template: '{{ is_state(repeat.item, ''off'') or is_state(repeat.item,
          ''idle'') }}'
      - choose:
        - conditions:
          - condition: time
            after: 08:00:00
            before: '21:00:00'
          sequence:
          - action: media_player.volume_set
            target:
              entity_id: '{{ repeat.item }}'
            data:
              volume_level: '{{ ( states( ''input_number.assistant_volume_day'' )
                | int ) / 100 }}

                '
        - conditions:
          - condition: time
            after: '21:00:00'
            before: '23:45:00'
          sequence:
          - action: media_player.volume_set
            target:
              entity_id: '{{ repeat.item }}'
            data:
              volume_level: '{{ ( states( ''input_number.assistant_volume_evening''
                ) | int ) / 100 }}

                '
        default:
        - action: media_player.volume_set
          target:
            entity_id: '{{ repeat.item }}'
          data_template:
            volume_level: '{{ ( states( ''input_number.assistant_volume_night'' )
              | int ) / 100 }}

              '
  mode: single
- alias: Alertar MacBook Porta da Cozinha Aberta
  id: '1737152867015'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.kitchen_door
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.joao_mac_book_active_home
    state: 'on'
  actions:
  - action: notify.mobile_app_joaocarreira_macbook_pro
    metadata: {}
    data:
      title: Segurança
      message: A Porta da Cozinha foi Aberta
  mode: single
- alias: Alertar MacBook Porta da Frente Aberta
  id: '1737152931894'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.front_door
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.joao_mac_book_active_home
    state: 'on'
  actions:
  - action: notify.mobile_app_joaocarreira_macbook_pro
    metadata: {}
    data:
      title: Segurança
      message: A Porta da Frente foi Aberta
  mode: single
- alias: Trigger Botões dos Estores do Quarto do Henrique
  id: '1737928610211'
  description: ''
  use_blueprint:
    path: devices/bhonofre_cover_buttons.yaml
    input:
      device: bhonofre_cover_bedroom_henrique
      main_double_top_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: script.hvac_turn_on_bedroom_henrique
      main_double_bottom_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: climate.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: climate.bedroom_henrique
      single_top_action: []
      single_bottom_action: []
      double_top_action:
      - action: script.hvac_turn_on_bedroom_henrique
      double_bottom_action:
      - action: climate.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: climate.bedroom_henrique
      triple_top_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: '{{ state_attr(''climate.bedroom_henrique'', ''temperature'')
            + 1 }}'
        target:
          entity_id: climate.bedroom_henrique
      triple_bottom_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: '{{ state_attr(''climate.bedroom_henrique'', ''temperature'')
            - 1 }}'
        target:
          entity_id: climate.bedroom_henrique
      long_top_action: []
      long_bottom_action: []
- alias: AC Hall - Ligar Modo Noturno
  id: '1738114770861'
  description: ''
  triggers:
  - trigger: time
    at: '22:00:00'
  - trigger: time
    at: '23:00:00'
  - trigger: state
    entity_id:
    - climate.hall
    from: 'off'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  - trigger: state
    entity_id:
    - binary_sensor.notify_home
    to: 'on'
    for:
      hours: 0
      minutes: 10
      seconds: 0
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: climate.hall
      state: 'off'
  - condition: time
    after: '22:00:00'
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'on'
  actions:
  - action: climate.set_preset_mode
    metadata: {}
    data:
      preset_mode: sleep
    target:
      entity_id: climate.hall
  mode: single
- alias: Desligar Coluna da Suite com as Luzes
  id: '1739048652626'
  description: ''
  triggers:
  - entity_id:
    - light.master_bedroom
    from: 'on'
    to: 'off'
    trigger: state
  conditions: []
  actions:
  - data: {}
    action: media_player.turn_off
    target:
      entity_id: media_player.ghm_master_bedroom
  mode: single
- alias: Fechar o Portão com a Casa Vazia
  id: '1744465759830'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.notify_home
    from:
    to: 'off'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  conditions:
  - condition: state
    entity_id: binary_sensor.house_guest
    state: 'off'
  actions:
  - action: cover.close_cover
    metadata: {}
    data: {}
    target:
      entity_id: cover.gate
  mode: single
- alias: Tablet Control Hall Screen
  id: '1750634052202'
  triggers:
  - entity_id:
    - input_select.house_mode
    - binary_sensor.notify_home
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: state
          entity_id: input_select.house_mode
          state: 'Off'
        - condition: state
          entity_id: input_select.house_mode
          state: Sleep
        - condition: state
          entity_id: binary_sensor.notify_home
          state: 'off'
      sequence:
      - device_id: 2ae8ef1981d03f83e4144debe519a697
        domain: number
        entity_id: c1fda8db1584b621a11a335919b54d27
        type: set_value
        value: 100
      - action: number.set_value
        data:
          value: '60'
        target:
          entity_id:
          - number.fire_tablet_screen_off_timer
      - action: switch.turn_off
        data: {}
        target:
          entity_id:
          - switch.fire_tablet_motion_detection
      - action: switch.turn_off
        target:
          entity_id:
          - switch.fire_tablet_screen
        data: {}
    - conditions:
      - condition: or
        conditions:
        - condition: state
          entity_id: input_select.house_mode
          state: Night
      sequence:
      - device_id: 2ae8ef1981d03f83e4144debe519a697
        domain: number
        entity_id: c1fda8db1584b621a11a335919b54d27
        type: set_value
        value: 100
      - action: number.set_value
        data:
          value: '60'
        target:
          entity_id:
          - number.fire_tablet_screen_off_timer
      - action: switch.turn_off
        data: {}
        target:
          entity_id:
          - switch.fire_tablet_motion_detection
    default:
    - device_id: 2ae8ef1981d03f83e4144debe519a697
      domain: number
      entity_id: c1fda8db1584b621a11a335919b54d27
      type: set_value
      value: 255
    - action: number.set_value
      data:
        value: '1200'
      target:
        entity_id:
        - number.fire_tablet_screen_off_timer
    - action: switch.turn_on
      data: {}
      target:
        entity_id:
        - switch.fire_tablet_motion_detection
  mode: restart
- alias: Fechar Estores Com Temperatura Elevada
  id: '1751552957136'
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.temperature_outside
    for:
      hours: 0
      minutes: 30
      seconds: 0
    above: 28
  conditions:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  - condition: state
    entity_id: input_boolean.extended_away_mode
    state: 'off'
  - condition: state
    entity_id: binary_sensor.house_guest
    state: 'off'
  actions:
  - data:
      action_to_run: cover.close_cover
      control_switch: close_with_heat
      covers_list:
      - living_room
      - stairs
      - bedroom_henrique
      - bedroom_ricardo
      - master_bedroom
      - bathroom
      - bedroom_rc
      - laundry
      - kitchen
      - office
    action: script.cover_group_action
  mode: single
- alias: helper_clear_routine_message
  id: '1754488924870'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - script.routine_good_night
    - script.routine_exit_house_all_off
    - script.routine_exit_house_to_work_bianca
    - script.routine_exit_house_to_work_joao
    - script.routine_leaving_and_coming_back
    from: 'on'
    to: 'off'
  conditions: []
  actions:
  - action: input_text.set_value
    metadata: {}
    data:
      value: ' '
    target:
      entity_id: input_text.script_step_message
  mode: single
- alias: Ar Condicionados - Ajustar com a casa vazia
  id: '1755213453554'
  description: Define o modo da ventoinha para 'auto' e o modo de oscilação para 'swing'
    em todos os aparelhos de ar condicionado quando a casa está vazia por 10 minutos.
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.notify_home
    to: 'off'
    for:
      hours: 0
      minutes: 10
      seconds: 0
  conditions:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  actions:
  - action: climate.set_fan_mode
    metadata: {}
    data:
      fan_mode: auto
    target:
      entity_id:
      - climate.master_bedroom
      - climate.living_room
      - climate.bedroom_ricardo
      - climate.office
      - climate.bedroom_henrique
      - climate.hall
  - action: climate.set_swing_mode
    metadata: {}
    data:
      swing_mode: swing
    target:
      entity_id:
      - climate.master_bedroom
      - climate.living_room
      - climate.bedroom_ricardo
      - climate.office
      - climate.bedroom_henrique
      - climate.hall
  mode: single
- alias: Trigger Botões dos Estores da Suite
  id: '1736719371438'
  description: ''
  use_blueprint:
    path: devices/bhonofre_cover_buttons.yaml
    input:
      device: bhonofre_cover_master_bed
      single_top_action:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          entity_id: light.master_bedroom_bed_window
      single_bottom_action:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          entity_id: light.master_bedroom_bed_wall
      main_double_top_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: script.hvac_turn_on_master_bedroom
      double_top_action:
      - action: script.hvac_turn_on_master_bedroom
      double_bottom_action:
      - action: climate.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: climate.master_bedroom
      triple_top_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: '{{ state_attr(''climate.master_bedroom'', ''temperature'')
            + 1 }}'
        target:
          entity_id: climate.master_bedroom
      triple_bottom_action:
      - condition: state
        entity_id: binary_sensor.house_guest
        state: 'off'
      - action: climate.set_temperature
        metadata: {}
        data:
          temperature: '{{ state_attr(''climate.master_bedroom'', ''temperature'')
            - 1 }}'
        target:
          entity_id: climate.master_bedroom
- alias: Abrir Parcialmente Estores Noite do R/C
  id: '1755902487203'
  description: ''
  triggers:
  - event: sunset
    offset: 00:05:00
    trigger: sun
  conditions:
  - condition: state
    entity_id: binary_sensor.notify_home
    state: 'off'
  actions:
  - data: {}
    action: cover.close_cover
    target:
      entity_id:
      - cover.laundry
      - cover.living_room
  - data:
      position: 30
    action: cover.set_cover_position
    target:
      entity_id: cover.laundry
  - data:
      position: 25
    action: cover.set_cover_position
    target:
      entity_id:
      - cover.living_room
  mode: single
- alias: security_alert_door_open
  id: '1756997660207'
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.kitchen_door
    - binary_sensor.front_door
    to: open
    for:
      hours: 0
      minutes: 0
      seconds: 30
    trigger: state
  - id: trigger_house_empty
    entity_id:
    - binary_sensor.notify_home
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 15
    trigger: state
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.kitchen_door
      state: 'on'
    - condition: state
      entity_id: binary_sensor.front_door
      state: 'on'
    alias: Se alguma das portas está aberta
  actions:
  - data:
      title: Exterior
      message: O Portão da Rua está Aberto
      data:
        tag: 301
        priority: high
        persistent: true
        sticky: true
        channel: Segurança
        clickAction: /lovelace-subviews/dashboard-exterior
        actions:
        - action: gate_notification_action_keep_open
          title: Deixar Aberto
        - action: gate_notification_action_close
          title: Fechar o Portao
    action: notify.mobile_app_all
  mode: restart
- alias: rain_set_last_event
  id: '1759091348299'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.rain
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 15
      seconds: 0
  conditions: []
  actions:
  - action: input_datetime.set_datetime
    metadata: {}
    data:
      timestamp: '{{ now().timestamp() }}'
    target:
      entity_id: input_datetime.last_rain
  mode: single
- alias: Alertar Portão em Movimento
  id: '1759755648327'
  description: ''
  triggers:
  - id: trigger_gate_open
    entity_id:
    - cover.gate
    to: opening
    for:
      hours: 0
      minutes: 5
      seconds: 0
    trigger: state
  - id: trigger_gate_open
    entity_id:
    - cover.gate
    to: closing
    for:
      hours: 0
      minutes: 5
      seconds: 0
    trigger: state
  - id: trigger_gate_close
    entity_id:
    - cover.gate
    to: close
    trigger: state
  conditions: []
  actions:
  - data:
      message: clear_notification
      data:
        tag: 302
        dismiss: true
    action: notify.mobile_app_all
  - action: notify.mobile_app_joao
    data:
      title: Exterior
      message: O Portão da Rua está em Movimento à mais de 5 min
      data:
        tag: 302
        priority: high
        persistent: true
        sticky: true
        channel: Segurança
        clickAction: /lovelace-subviews/dashboard-exterior
  mode: restart
- id: '1760144253958'
  alias: Alertar o Joao Henrique a Chorar
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.baby_monitor_henrique_crying_sound
    to:
    - 'on'
  conditions:
  - condition: state
    state: 'on'
    entity_id: binary_sensor.joao_home
  - condition: template
    value_template: '{{ now().timestamp() - (this.attributes.last_triggered | as_timestamp
      | int(0)) > 60 * 30 }}'
  - condition: state
    entity_id: light.bedroom_henrique
    state:
    - 'off'
    for:
      hours: 0
      minutes: 10
      seconds: 0
  - condition: state
    entity_id: cover.bedroom_henrique
    state:
    - closed
    for:
      hours: 0
      minutes: 10
      seconds: 0
  actions:
  - action: notify.mobile_app_joao
    metadata: {}
    data:
      title: Baby Monitor
      message: O Henrique está a chorar
  mode: single
- id: '1760144554168'
  alias: Alertar o Joao Ricardo a Chorar
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.baby_monitor_ricardo_crying_sound
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.joao_home
    state: 'on'
  - condition: template
    value_template: '{{ now().timestamp() - (this.attributes.last_triggered | as_timestamp
      | int(0)) > 60 * 30 }}'
  - condition: state
    entity_id: light.bedroom_ricardo
    state:
    - 'off'
    for:
      hours: 0
      minutes: 10
      seconds: 0
  - condition: state
    entity_id: cover.bedroom_ricardo
    state:
    - closed
    for:
      hours: 0
      minutes: 10
      seconds: 0
  actions:
  - action: notify.mobile_app_joao
    metadata: {}
    data:
      title: Baby Monitor
      message: O Ricardo está a chorar
  mode: single
- alias: AC da Sala - Ligar de Tarde no Verão
  id: '1751200610784'
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: false
      schedule_start: '17:00:00'
      schedule_end: '20:30:00'
      hvac_unit:
      - climate.living_room
      hvac_temperature: 24
      room_temperature: 24
      temperature_sensor: sensor.temperature_living_room
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      selected_season:
      - summer
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_ground_floor
- alias: AC Hall - Ligar de Tarde no Verão (Fim de Semana)
  id: '1751200671929'
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: false
      schedule_start: '14:00:00'
      schedule_end: '20:30:00'
      hvac_unit:
      - climate.hall
      hvac_temperature: 24
      room_temperature: 24
      temperature_sensor: sensor.temperature_hall
      weekday:
      - sat
      - sun
      selected_season:
      - summer
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- alias: AC Hall - Ligar de Tarde no Verão
  id: '1749604497079'
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: false
      schedule_start: '16:00:00'
      schedule_end: '20:30:00'
      hvac_unit:
      - climate.hall
      hvac_temperature: 24
      room_temperature: 24
      temperature_sensor: sensor.temperature_hall
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      selected_season:
      - summer
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- id: '1749602497079'
  alias: AC Quarto do Ricardo - Ligar de Tarde no Verão
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: false
      schedule_start: '16:00:00'
      schedule_end: '20:30:00'
      hvac_unit:
      - climate.bedroom_ricardo
      hvac_temperature: 25
      room_temperature: 27
      temperature_sensor: sensor.temperature_bedroom_ricardo
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      selected_season:
      - summer
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- id: '1739604497079'
  alias: AC Quarto do Henrique - Ligar de Tarde no Verão
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: false
      schedule_start: '16:00:00'
      schedule_end: '20:30:00'
      hvac_unit:
      - climate.bedroom_henrique
      hvac_temperature: 25
      room_temperature: 27
      temperature_sensor: sensor.temperature_bedroom_henrique
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      selected_season:
      - summer
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- alias: AC Suite - Ligar de Tarde no Verão
  id: '1749604597079'
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: false
      schedule_start: '16:00:00'
      schedule_end: '20:30:00'
      hvac_unit:
      - climate.master_bedroom
      hvac_temperature: 25
      room_temperature: 27
      temperature_sensor: sensor.temperature_master_bedroom
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      selected_season:
      - summer
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- id: '1705368431534'
  alias: AC Sala - Ligar de Manhã no Inverno
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: 06:30:00
      schedule_end: 08:00:00
      hvac_unit:
      - climate.living_room
      hvac_temperature: 22
      room_temperature: 21
      temperature_sensor: sensor.temperature_living_room
      window_sensor: binary_sensor.window_ground_floor
      weekday:
      - mon
      - wed
      - thu
      - fri
      - tue
      - sat
      - sun
      selected_season:
      - winter
      - autumn
      - spring
      hvac_delayed_temperature_offset: -1
- id: '1737768400854'
  alias: AC Hall - Ligar de Manhã no Inverno
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: 06:00:00
      schedule_end: 08:00:00
      hvac_unit:
      - climate.hall
      hvac_temperature: 22
      room_temperature: 21
      temperature_sensor: sensor.temperature_hall
      weekday:
      - mon
      - wed
      - thu
      - fri
      - tue
      - sat
      - sun
      selected_season:
      - winter
      - autumn
      - spring
      hvac_delayed_temperature_offset: 0
      window_sensor: binary_sensor.window_bedroom_floor
      extra_hvac_actions:
      - action: switch.turn_off
        metadata: {}
        target:
          entity_id: switch.hall_ac_display
        data: {}
- id: '1705368338092'
  alias: AC Suite - Ligar de Manhã no Inverno
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: 07:15:00
      schedule_end: 08:00:00
      hvac_unit: climate.master_bedroom
      hvac_temperature: 22
      room_temperature: 21
      temperature_sensor: sensor.temperature_master_bedroom
      window_sensor: binary_sensor.window_master_bedroom
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      selected_season:
      - winter
      - spring
      - autumn
- id: '1705596387713'
  alias: AC Sala - Ligar de Tarde no Inverno
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: '16:30:00'
      schedule_end: '18:00:00'
      hvac_unit:
      - climate.living_room
      hvac_temperature: 21
      room_temperature: 21
      temperature_sensor: sensor.temperature_living_room
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      selected_season:
      - autumn
      - winter
      - spring
      window_sensor: binary_sensor.window_ground_floor
- alias: AC Escritório - Ligar de Tarde no Inverno
  id: '1737772761289'
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: '16:30:00'
      schedule_end: '20:00:00'
      hvac_unit: climate.office
      hvac_temperature: 20
      room_temperature: 19.5
      temperature_sensor: sensor.temperature_office
      window_sensor: binary_sensor.window_ground_floor
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      selected_season:
      - autumn
      - winter
      - spring
      hvac_delayed_temperature_offset: 0
      extra_hvac_actions: []
- alias: AC Quartos - Ligar de Tarde no Inverno
  id: '1737850856162'
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: '16:30:00'
      schedule_end: '20:00:00'
      hvac_unit:
      - climate.hall
      - climate.bedroom_henrique
      - climate.bedroom_ricardo
      - climate.master_bedroom
      hvac_temperature: 20
      room_temperature: 19
      temperature_sensor: sensor.temperature_bedrooms
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      selected_season:
      - autumn
      - winter
      - spring
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- id: '1737768630507'
  alias: AC Hall - Ligar de Tarde no Inverno
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: '16:45:00'
      schedule_end: '20:00:00'
      hvac_unit:
      - climate.hall
      hvac_temperature: 22
      room_temperature: 21.5
      temperature_sensor: sensor.temperature_hall
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      selected_season:
      - winter
      - autumn
      - spring
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- id: '1705596272069'
  alias: AC Suite - Ligar de Tarde no Inverno
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: '17:00:00'
      schedule_end: '20:00:00'
      hvac_unit:
      - climate.master_bedroom
      hvac_temperature: 22
      room_temperature: 21
      temperature_sensor: sensor.temperature_master_bedroom
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      selected_season:
      - autumn
      - winter
      - spring
      hvac_delayed_temperature_offset: 0
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- id: '1705596348371'
  alias: AC Quarto do Ricardo - Ligar de Tarde no Inverno
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: '17:00:00'
      schedule_end: '20:00:00'
      hvac_unit:
      - climate.bedroom_ricardo
      hvac_temperature: 22
      room_temperature: 21
      temperature_sensor: sensor.temperature_bedroom_ricardo
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      selected_season:
      - autumn
      - winter
      - spring
      hvac_delayed_temperature_offset: 0
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- id: '1737770376538'
  alias: AC Quarto do Henrique - Ligar de Tarde no Inverno
  description: ''
  use_blueprint:
    path: hvac/hvac_time_turn_on.yaml
    input:
      hvac_mode_heat: true
      schedule_start: '17:00:00'
      schedule_end: '20:00:00'
      hvac_unit:
      - climate.bedroom_henrique
      hvac_temperature: 21
      room_temperature: 20.5
      temperature_sensor: sensor.temperature_bedroom_henrique
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
      selected_season:
      - autumn
      - winter
      - spring
      extra_hvac_actions: []
      window_sensor: binary_sensor.window_bedroom_floor
- id: '1762307515538'
  alias: Luzes por Mov. no Quarto de Arrumos
  description: ''
  use_blueprint:
    path: lights/motion_based_lights_v3.yaml
    input:
      motion_sensor: binary_sensor.motion_sensor_bedroom_rc
      target_entity: light.bedroom_rc
      min_repetition_interval_sec: 10
      only_after_sunset: false
      disable_in_guest: true
      required_house_mode: Dia+Anoitecer
      room_name: Quarto de Arrumos
      blocker_on_entity: light.bedroom_rc
      disable_in_sleep: true
      presence_sensor: none
      no_motion_wait: 60
      illuminance_cutoff: 75
      illuminance_sensor: none
- id: '1763600787785'
  alias: Desligar Luz de Presença do Corredor Com as Outras Luzes
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - light.living_room_group
    - light.doorway
    - light.hallway
    to:
    - 'on'
  - trigger: state
    entity_id:
    - light.living_room_group
    - light.doorway
    - light.hallway
    to:
    - 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 10
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.hallway_presence
  mode: single
- id: '1765128555699'
  alias: Desligar Luz da Casa de Banho de Serviço Sem Movimento
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_sensor_bathroom_rc
    from:
    - 'on'
    to:
    - 'off'
    for:
      hours: 0
      minutes: 10
      seconds: 0
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      area_id: bathroom_rc
  mode: single
- id: '1765413716782'
  alias: Controlar Estado da Tomada da TV
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.notify_home
    from:
    - 'on'
    to:
    - 'off'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - trigger: state
    entity_id:
    - binary_sensor.notify_home
    from: 'off'
    to: 'on'
  - trigger: time
    at: 07:10:00
  - trigger: time
    at: 02:10:00
  - trigger: state
    entity_id:
    - media_player.living_room_tv
    from:
    to:
    for:
      hours: 0
      minutes: 10
      seconds: 0
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: switch.living_room_tv
      state:
      - 'off'
      for:
        hours: 0
        minutes: 10
        seconds: 0
    - condition: state
      entity_id: switch.living_room_tv
      state:
      - 'on'
      for:
        hours: 0
        minutes: 10
        seconds: 0
  - condition: not
    conditions:
    - condition: state
      entity_id: media_player.living_room_tv
      state:
      - 'on'
  actions:
  - if:
    - condition: not
      conditions:
      - condition: state
        entity_id: binary_sensor.notify_home
        state:
        - 'off'
    - condition: time
      after: 07:00:00
      before: 02:00:00
    then:
    - action: switch.turn_on
      metadata: {}
      target:
        entity_id: switch.living_room_tv
      data: {}
    else:
    - action: media_player.turn_off
      metadata: {}
      target:
        entity_id: media_player.living_room_tv
      data: {}
    - delay:
        hours: 0
        minutes: 0
        seconds: 30
        milliseconds: 0
    - action: switch.turn_off
      metadata: {}
      target:
        entity_id: switch.living_room_tv
      data: {}
  mode: single
- id: '1765502075668'
  alias: baby_monitor_alert_joao_ricardo_moving
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.baby_monitor_ricardo_crying_sound
    to: 'on'
  conditions:
  - condition: template
    value_template: '{{ now().timestamp() - (this.attributes.last_triggered | as_timestamp
      | int(0)) > 60 * 30 }}'
  - condition: state
    entity_id: binary_sensor.joao_home
    state: 'on'
  - condition: time
    after: '21:30:00'
    before: 04:00:00
  - condition: state
    entity_id: cover.bedroom_ricardo
    state:
    - closed
    for:
      hours: 0
      minutes: 10
      seconds: 0
  - condition: state
    entity_id: light.bedroom_ricardo
    state:
    - 'off'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  actions:
  - action: notify.mobile_app_joao
    metadata: {}
    data:
      title: Baby Monitor
      message: O Ricardo está de  pé
  mode: single
- id: '1765502279075'
  alias: lights_motion_backyard
  description: ''
  use_blueprint:
    path: lights/motion_based_lights_v3.yaml
    input:
      motion_sensor: binary_sensor.backyard_camera_person
      target_entity: light.kitchen_door
      no_motion_wait: 60
      illuminance_cutoff: 50
      only_after_sunset: false
      disable_in_guest: true
      blocker_on_entity: light.kitchen_door
      required_house_mode: Todos
      room_name: Exterior
      disable_in_sleep: false
      presence_sensor: none
      required_conditions:
      - condition: not
        conditions:
        - condition: state
          entity_id: light.exterior_wall_back
          state:
          - 'off'
- id: '1765845791576'
  alias: Desligar Luz da Sala Sem Movimento
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_sensor_living_room_group
    from:
    - 'on'
    to:
    - 'off'
    for:
      hours: 0
      minutes: 60
      seconds: 0
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.living_room
      - light.doorway
      - light.living_room_window
  mode: single
- id: '1765846031339'
  alias: Desligar Luz da Cozinha Sem Movimento
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_sensor_kitchen
    from:
    - 'on'
    to:
    - 'off'
    for:
      hours: 0
      minutes: 60
      seconds: 0
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      area_id: kitchen
  mode: single
- id: '1765846195706'
  alias: Desligar Luz do Escritório Sem Movimento
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_sensor_office
    to:
    - 'off'
    for:
      hours: 0
      minutes: 60
      seconds: 0
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      area_id: office
  mode: single
- id: '1766190630106'
  alias: Test Shelly Buttons
  description: ''
  triggers:
  - device_id: 6a6e337567ed440bc250b4b9fe39ca3c
    domain: bthome
    type: button_1
    subtype: press
    trigger: device
  conditions: []
  actions:
  - action: light.toggle
    metadata: {}
    target:
      entity_id: light.office
    data: {}
  mode: single
