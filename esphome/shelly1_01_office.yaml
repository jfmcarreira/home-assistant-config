substitutions:
  devicename: shelly1_office
  upper_devicename: Office

esphome:
  name: ${devicename}
  platform: ESP8266
  board: esp01_1m

wifi:
  domain: .home
  ssid: !secret esp_wifi_ssid
  password: !secret esp_wifi_pass

# Enable logging
logger:

# Enable Home Assistant API
api:
  reboot_timeout: 600s

ota:

binary_sensor:
  - id: sw_1
    platform: gpio
    pin:
      number: GPIO5
    on_state:
      then:
        - if:
            condition:
              api.connected:
            then:
              - switch.turn_on: relay_1
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.office
            else:
              - switch.toggle: relay_1

switch:
  - platform: gpio
    pin: GPIO04
    id: relay_1
    name: ${upper_devicename} SW
    restore_mode: ALWAYS_OFF
