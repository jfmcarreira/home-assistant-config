substitutions:
  DeviceName: shelly1_kitchen_door
  FriendlyName: Shelly 1 Kitchen Door
  PowerSaveMode: NONE

packages:
  esphome_base: !include packages/common.yml

esphome:
  name: ${DeviceName}
  platform: ESP8266
  board: esp01_1m

# Enable Home Assistant API
api:
  reboot_timeout: 600s

output:
  - platform: gpio
    pin: GPIO04
    id: relay_1

light:
  - id: light_1
    name: Kitchen Door
    platform: binary
    output: relay_1
    restore_mode: RESTORE_AND_OFF

binary_sensor:
  - id: sw_1
    platform: gpio
    pin:
      number: GPIO5
    on_state:
      then:
        - if:
            condition:
              api.connected:
            then:
              - light.toggle: light_1
            else:
              - light.toggle: light_1

