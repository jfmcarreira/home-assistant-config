title: Potência
path: power
panel: true
icon: 'mdi:flash'
badges: []
cards:
  - type: 'custom:layout-card'
    max_columns: 2
    layout: vertical
    cards:
      - type: 'custom:button-card'
        aspect_ratio: 11/2
        entity: script.task_roborock_clean
        icon: 'mdi:arrow-left'
        layout: icon_name_state
        name: Voltar
        tap_action:
          action: navigate
          navigation_path: /fire-tablet/main
        hold_action: none
      - type: 'custom:vertical-stack-in-card'
        title: Potência Instantânea
        cards:
          - entity: sensor.bhpzem_power
            max: 3400
            min: 0
            name: Potência
            type: gauge
          - entities:
              - entity: sensor.bhpzem_voltage
              - entity: sensor.bhpzem_current
              - entity: sensor.bhpzem_pf
              - entity: sensor.bhpzem_frequency
            show_icon: false
            type: glance
          - entities:
              - entity: sensor.bhpzem_power
            height: 150
            hours_to_show: 24
            line_width: 1
            name: Últimas 24 Horas
            points_per_hour: 10
            show:
              average: false
              extrema: true
              graph: line
              labels_secondary: false
              points: hover
              state: true
            type: 'custom:mini-graph-card'
      - type: entities
        title: Consumo Anual
        entities:
          - type: 'custom:chartjs-card'
            chart: bar
            custom_options:
              showLegend: false
            data:
              datasets:
                - backgroundColor: var(--accent-color)
                  borderWidth: 1
                  data: >-
                    ${states["sensor.query_month_energy_current_year"].attributes.data}
                  label: Eletricidade
              labels: >-
                ${states["sensor.query_month_energy_current_year"].attributes.labels}
            entity_row: true
            options:
              scales:
                yAxes:
                  - ticks:
                      beginAtZero: true
              title:
                display: false
                text: Consumo energético (últimos 12 meses)
      - break
      - type: entities
        title: Consumo Mês Corrente
        entities:
          - type: 'custom:chartjs-card'
            chart: bar
            custom_options:
              showLegend: false
            data:
              datasets:
                - backgroundColor: >-
                    ${states["sensor.query_daily_energy_current_month"].attributes.colors}
                  borderWidth: 1
                  data: >-
                    ${states["sensor.query_daily_energy_current_month"].attributes.data}
                  label: Eletricidade
              labels: >-
                ${states["sensor.query_daily_energy_current_month"].attributes.labels}
            entity_row: true
            options:
              scales:
                yAxes:
                  - ticks:
                      beginAtZero: true
              title:
                display: false
                text: Consumo Energético Mês Corrente
          - type: 'custom:chartjs-card'
            chart: doughnut
            entity_row: true
            data:
              datasets:
                - data:
                    - >-
                      ${states["sensor.query_month_energy_living_room"].state}
                    - >-
                      ${states["sensor.query_month_energy_office_desk"].state}
                    - >-
                      ${states["sensor.query_month_energy_kitchen_oven"].state}
                    - '${states["sensor.query_month_energy_microwave"].state}'
                    - >-
                      ${states["sensor.query_month_energy_washing_machine"].state}
                    - >-
                      ${states["sensor.query_month_energy_dish_wash_machine"].state}
                    - '${states["sensor.query_month_energy_fridge"].state}'
                    - '${states["sensor.query_month_energy_iron"].state}'
                    - >-
                      ${states["sensor.query_month_energy_portable_heater"].state}
                    - '${states["sensor.query_month_energy_lights"].state}'
                    - '${states["sensor.query_month_energy_remaining"].state}'
                  backgroundColor:
                    - '#D3321D'
                    - '#D74224'
                    - '#DC512C'
                    - '#E06133'
                    - '#E5713B'
                    - '#E98142'
                    - '#ED9049'
                    - '#F2A051'
                    - '#F6B058'
                    - '#FBBF60'
                    - '#FFCF67'
                  borderColor:
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
                    - var(--secondary-background-color)
              labels:
                - Centro Multimédia
                - Secretária do Escritório
                - Fogão/Forno
                - Micro-ondas/Torradeira
                - Máq. Lavar Roup
                - Máq. Lavar Loiça
                - Frigorifico
                - Ferro de Engomar
                - Termoventilador
                - Iluminação
                - Outros
            options:
              aspectRatio: 1.6
              legend:
                position: left
      - break
      - type: entities
        entities:
          - entity: sensor.daily_energy_lights
            name: Luzes
          - entity: sensor.daily_energy_living_room
            name: Sala de Estar / Multimédia
          - entity: sensor.daily_energy_office_desk
            name: Secretária do Escritório
          - entity: sensor.daily_energy_kitchen_oven
            name: Forno / Fogão
          - entity: sensor.daily_energy_microwave
            name: Microondas/Torradeira
          - entity: sensor.daily_energy_fridge
            name: Frigorifico
          - entity: sensor.daily_energy_dish_wash_machine
            name: Máquina de Lavar Loiça
          - entity: sensor.daily_energy_washing_machine
            name: Máquina de Lavar Roupa
          - entity: sensor.daily_energy_portable_heater
            name: Termoventilador
          - entity: sensor.daily_energy_iron
            name: Ferro de Engomar
          - entity: sensor.daily_energy_remaining
            name: Outros
            icon: 'mdi:flash-circle'
        title: Energia Diária
      - break
      - card:
          show_header_toggle: false
          title: Potência Consumida
          type: entities
        filter:
          include:
            - entity_id: sensor.power_sensor_*
            - entity_id: sensor.power_usage_device_*
            - entity_id: sensor.power_usage_lights
        show_empty: false
        sort:
          ignore_case: true
          method: entity_id
        type: 'custom:auto-entities'
      - break
