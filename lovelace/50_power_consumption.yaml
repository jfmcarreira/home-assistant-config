title: Power
path: power
badges: []
#icon: mdi:flash
icon: mdi:flash
panel: true
cards:
  - type: custom:layout-card
    layout: vertical
    max_columns: 3
    cards:
      - type: custom:vertical-stack-in-card
        title: Consumo Energético
        cards:
          - type: gauge
            #entity: sensor.total_power_usage
            entity: sensor.bhpzem_power
            name: Total
            max: 3450
            severity:
              green: 0
              yellow: 2500
              red: 3200

          - type: glance
            entities:
              - entity: sensor.bhpzem_voltage
                name: Tensão
              - entity: sensor.bhpzem_current
                name: Corrente
              - entity: sensor.bhpzem_pf
                name: FP
              - entity: sensor.bhpzem_frequency
                name: Frequência
              
          - type: custom:auto-entities
            show_empty: false
            card:
              type: entities
              show_header_toggle: false
            filter:
              include:
                - entity_id: sensor.power_sensor_*
                
          #- type: custom:auto-entities
            #show_empty: false
            #card:
              #type: entities
              ##title: Power
              #show_header_toggle: false
            #filter:
              #include:
                #- entity_id: sensor.bhpzem_*
                ##- entity_id: sensor.pzem_energy
              #exclude:
                #- entity_id: sensor.bhpzem_energy
                #- entity_id: sensor.bhpzem_power
                #- entity_id: sensor.bhpzem_power_manual
          
          - type: entities
            show_header_toggle: false
            entities:
              - entity: sensor.daily_energy
                name: Total Diário
              - entity: sensor.monthly_energy
                name: Consumo
              - entity: sensor.monthly_energy_cost
                name: Preço

      - break

      - type: custom:mini-graph-card
        name: Potência Últimas 48 Horas
        hours_to_show: 48
        points_per_hour: 5
        height: 150
        line_width: 1
        show:
          state: true
          points: hover
          average: false
          extrema: true
          labels_secondary: false
          graph: line
        entities:
          - entity: sensor.bhpzem_power

      - type: custom:mini-graph-card
        name: Potência Média Consumida
        hours_to_show: 120
        points_per_hour: 6
        aggregate_func: avg
        group_by: date
        show:
          graph: bar
          state: false
          extrema: true
        entities:
          - entity: sensor.bhpzem_power      
      

      # - type: custom:mini-graph-card
      #   name: Power Consumption
      #   hours_to_show: 120
      #   points_per_hour: 6
      #   aggregate_func: avg
      #   group_by: date
      #   show:
      #     graph: bar
      #   entities:
      #     - entity: sensor.pzem_power

      # - type: custom:mini-graph-card
      #   name: Power Last 2 Hours
      #   hours_to_show: 2
      #   points_per_hour: 60
      #   height: 150
      #   line_width: 1
      #   show:
      #     state: true
      #     points: hover
      #     average: false
      #     extrema: true
      #     labels_secondary: false
      #     graph: line
      #   entities:
      #     - entity: sensor.power_usage_living_room
      #       name: Living Room
      #     - entity: sensor.power_usage_office
      #       name: Office
      #     - entity: sensor.power_usage_bedroom
      #       name: Bedroom
      #     - entity: sensor.power_usage_kitchen
      #       name: Kitchen
      #     - entity: sensor.power_usage_kitchen_oven
      #       name: Kitchen Oven
      #     - entity: sensor.power_usage_kitchen_fridge
      #       name: Kitchen Fridge
      #     - entity: sensor.power_usage_laundry
      #       name: Laundry

      
      - type: custom:auto-entities
        show_empty: false
        card:
          type: entities
          title: Potência Dispositivos
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.power_usage_shelly_*
                
      - break
      
      - type: custom:vertical-stack-in-card
        title: Utilidades
        cards:
          - type: entities
            title: Electricidade
            show_header_toggle: false
            entities:
              - entity: sensor.electricity_last_meter 
                name: Última Contagem
              - entity: sensor.electricity_meter
                name: Contagem Total
              - entity: input_number.electricity_meter_offpeak
                name: Contagem Vazio
              - entity: input_number.electricity_meter_peak
                name: Contagem Pontas
              - entity: input_number.electricity_meter_full 
                name: Contagem Cheias            
              
          - type: entities
            title: Gás
            show_header_toggle: false
            entities:
              - entity: sensor.gas_last_meter 
                name: Última Contagem
              - entity: input_number.gas_meter
                name: Contagem Gás 
          - type: entities
            title: Água
            show_header_toggle: false
            entities:
              - entity: sensor.water_last_meter 
                name: Última Contagem
              - entity: input_number.water_meter
                name: Contagem Água 
      
