id: main
title: Main 
path: main
icon: 'mdi:home'  
panel: true
cards:
  - type: "custom:layout-card"
    layout: vertical
    max_columns: 4
    cards:
      
      - type: weather-forecast
        entity: weather.ipma
        details: true
        forecast: true
        
      
      - break 
      
      - type: horizontal-stack
        cards:
          - type: picture-entity 
            aspect_ratio: 1.3/1
            entity: person.joao
            image: /local/img_joao.jpg
            show_name: false
            state_filter:
              away: grayscale(100%)
              home: grayscale(0%)
            #tap_action:
              #action: call-service
              #service: browser_mod.popup
              #service_data:
                #card:
                  #entities:
                    #- entity: person.joao
                      #name: Localização
                    #- entity: proximity.dist_home_joao
                      #name: Distancia
                    #- binary_sensor.magnesium
                    #- binary_sensor.pegasus
                    #- binary_sensor.boron
                  #type: entities
                #deviceID:
                  #- this
                #title: João
          - type: picture-entity
            aspect_ratio: 1.3/1
            entity: person.bianca
            image: /local/img_bianca.jpg
            show_name: false
            state_filter:
              away: grayscale(100%)
              home: grayscale(0%)
            #tap_action:
              #action: call-service
              #service: browser_mod.popup
              #service_data:
                #title: Bianca
                #card:
                    
                #deviceID:
                  #- this
            
          - type: picture-entity
            aspect_ratio: 1.3/1
            entity: input_boolean.ricardo_sleeping
            image: /local/img_ricardo.jpg
            show_name: false
            state_filter:
              away: grayscale(100%)
              home: grayscale(0%)
            hold_action:
              action: call-service
              service: input_boolean.toggle
              service_data:
                entity_id: input_boolean.ricardo_sleeping
            #tap_action:
              #action: call-service
              #service: browser_mod.popup
              #service_data:
                #card:
                  #entities:
                    #- entity: sensor.ricardo_weight
                    #- entity: binary_sensor.ricardo_vitamin_d
                      #name: Vitamina D
                    #- entity: sensor.ricardo_vitamin_d_last_done
                    ##- entity: sensor.office_water_sensor
                      ##name: Água do banho
                  #footer:
                    #entities:
                      #- entity: script.task_ricardo_vitamin_d
                        #icon: 'mdi:pill'
                    #type: buttons
                  #type: entities
                #deviceID:
                  #- this
                #title: Ricardo
          - type: picture-entity
            aspect_ratio: 1.3/1
            entity: binary_sensor.cat_litter_box_need_clean
            hold_action:
              action: call-service
              service: python_script.catlitter_reset
            image: /local/img_cats.jpg
            show_name: false
            state_filter:
              'off': grayscale(0%)
              'on': grayscale(72%)
            #tap_action:
              #action: call-service
              #service: browser_mod.popup
              #service_data:
                #card:
                  #cards:
                    #- entities:
                        #- binary_sensor.litter_box_motion
                        #- counter.cat_litter_box_visits
                        #- sensor.cat_litter_box_last_visit
                        #- sensor.cat_litter_box_last_clean
                        #- sensor.cat_litter_box_last_change
                      #footer:
                        #entities:
                          #- entity: script.cat_litter_clean
                            #icon: 'mdi:shovel'
                          #- entity: script.cat_litter_change
                            #icon: 'mdi:autorenew'
                        #type: buttons
                      #type: entities
                  #type: 'custom:vertical-stack-in-card'
                #deviceID:
                  #- this
                #title: Fluffy/Pluma       
        
      - type: horizontal-stack
        cards:
          - type: 'custom:button-card'
            aspect_ratio: 4/2
            custom_fields:
              notification: |
                [[[
                  if (states['binary_sensor.notify_home'].state == "on")
                    return `<ha-icon icon="mdi:home"      style="width: 18px; height: 18px;"> </ha-icon>`
                ]]]
            entity: input_boolean.house_guest
            size: 100%
            styles:
              custom_fields:
                notification:
                  - border-radius: 0%
                  - position: absolute
                  - left: 10%
                  - top: 10%
                  - height: 20px
                  - width: 20px
                  - font-size: 8px
                  - line-height: 20px
                  - icon: 'mdi:home'
              grid:
                - position: relative
            
          - type: 'custom:button-card'
            aspect_ratio: 4/2
            entity: input_boolean.notification_active_non_disturb
            state:
              - operator: template
                value: >
                  [[[ return states['binary_sensor.notification_non_disturb'].state === 'on' ]]] 
                icon: mdi:bell-off
              - operator: default
                icon: mdi:bell
            tap_action:
              action: call-service
              service: input_boolean.toggle
              service_data:
                entity_id: input_boolean.notification_active_non_disturb
            hold_action:
              action: more-info
            name: Não Incomodar
            size: 100%
            
          - type: 'custom:button-card'
            aspect_ratio: 4/2
            entity: script.night_away
            hold_action:
              action: call-service
              service: script.turn_on
              service_data:
                entity_id: script.routine_night_time
            icon: 'mdi:weather-night'
            name: Night/Away
            size: 100%
            tap_action:
              action: none
            
        
      - type: horizontal-stack
        cards:
          - aspect_ratio: 4/2
            custom_fields:
              dry_clothes: |
                [[[
                  if (states['binary_sensor.wash_machine_dry_clothes'].state == "on")
                    return `<ha-icon icon="mdi:tshirt-crew"      style="width: 18px; height: 18px;"> </ha-icon>`
                ]]]
              wet_clothes: |
                [[[
                  if (states['binary_sensor.wash_machine_wet_clothes'].state == "on")
                    return `<ha-icon icon="mdi:hanger"      style="width: 18px; height: 18px;"> </ha-icon>`
                ]]]
            entity: binary_sensor.washing_machine_state
            name: Máquina da Roupa
            hold_action:
              action: call-service
              service: python_script.whashing_machine_process_actions
            size: 100%
            state:
              - operator: template
                value: >
                  [[[ return states['binary_sensor.wash_machine_wet_clothes'].state === 'off' ]]] 
                icon: mdi:washing-machine
              - operator: template
                value: >
                  [[[ return states['binary_sensor.wash_machine_wet_clothes'].state === 'on' ]]] 
                icon: mdi:washing-machine-alert
            styles:
              custom_fields:
                dry_clothes:
                  - position: absolute
                  - right: 10%
                  - top: 10%
                wet_clothes:
                  - position: absolute
                  - left: 10%
                  - top: 10%
              grid:
                - position: relative
            type: 'custom:button-card'
          - aspect_ratio: 4/2
            entity: binary_sensor.dish_wash_machine_state
            name: Máquina da Loiça
            hold_action:
              action: call-service
              service: script.task_dish_wash_machine_empty
            size: 100%
            state:
              - operator: template
                value: >
                  [[[ return states['binary_sensor.dish_wash_machine_need_emtpy'].state === 'off' ]]] 
                icon: mdi:dishwasher
              - operator: template
                value: >
                  [[[ return states['binary_sensor.dish_wash_machine_need_emtpy'].state === 'on' ]]] 
                icon: mdi:dishwasher-alert
            custom_fields:
              clean_dishes: |
                [[[
                  if (states['binary_sensor.dish_wash_machine_need_emtpy'].state == "on")
                    return `<ha-icon icon="mdi:silverware-clean"      style="width: 18px; height: 18px;"> </ha-icon>`
                ]]]
            styles:
              custom_fields:
                clean_dishes:
                  - position: absolute
                  - left: 10%
                  - top: 10%
              grid:
                - position: relative
            type: 'custom:button-card'
          - aspect_ratio: 4/2
            entity: binary_sensor.ricardo_vitamin_d
            hold_action:
              action: call-service
              service: script.task_ricardo_vitamin_d
            name: Vitamina D
            type: 'custom:button-card'
      
      - break 
      
      - type: custom:mini-media-player
        #type: media-control
        entity: media_player.media_center
        name: Televisão da Sala
        hide: 
          volume: true
      
      - card:
          show_header_toggle: false
          title: Luzes
          type: entities
        filter:
          include:
            - entity_id: light.front_door*
              sort:
                ignore_case: true
                method: entity_id
            - entity_id: light.hallway*
              sort:
                ignore_case: true
                method: entity_id
            - entity_id: light.living_room*
              sort:
                ignore_case: true
                method: entity_id
            - entity_id: light.kitchen*
              sort:
                ignore_case: true
                method: entity_id
            - entity_id: light.master_bedroom*
              sort:
                ignore_case: true
                method: entity_id
            - entity_id: light.bedroom*
              sort:
                ignore_case: true
                method: entity_id
            - entity_id: light.office*
              sort:
                ignore_case: true
                method: entity_id
          exclude:
            - entity_id: light.browser*
            - entity_id: light.configuration_tool_1
            - entity_id: light.*_group
            - entity_id: light.*_output   
            - state: "unavailable"
          #template: |
            #{%if is_state('input_boolean.ricardo_sleeping', 'off' )%}light.bedroom_ricardo{% endif %}
          #entity_ids:
            #- input_boolean.ricardo_sleeping
          #sort:
            #ignore_case: true
            #method: entity_id
        show_empty: true
        
        type: 'custom:auto-entities'
        
      #- type: entities
        #show_header_toggle: false
        #entities:
          #- light.living_room_abajur
          #- type: 'custom:slider-entity-row'
            #entity: light.living_room_abajur
            #name: Brilho Luz de Apoio

      
      - break 
      - break 
      
      - cards:
          - agregate_func: avg
            entities:
              - sensor.average_temperature
            group_by: 1h
            height: 100
            hour24: true
            hours_to_show: 24
            line_width: 3
            name: Temperatura
            points_per_hour: 1
            show:
              average: false
              extrema: false
              points: hover
            type: 'custom:mini-graph-card'
          - agregate_func: avg
            entities:
              - sensor.average_humidity
            group_by: 1h
            height: 110
            hour24: true
            hours_to_show: 24
            line_width: 3
            name: Humidade
            points_per_hour: 1
            show:
              average: false
              extrema: false
              points: hover
            type: 'custom:mini-graph-card'
        type: horizontal-stack
        
      - control:
          _names: 'off'
        entity: climate.heating
        modes:
          heat:
            icon: false
            include: true
            name: Quente
        name: Aquecimento
        sensors:
          - entity: sensor.heating_ongoing_water_temperature
            name: Water
        type: 'custom:simple-thermostat'
      
      - break 
      
      
      - cards:
          - agregate_func: avg
            entities:
              - sensor.bhpzem_power
            group_by: 1800s
            height: 60
            hour24: true
            hours_to_show: 24
            line_width: 2
            name: Potência Consumida
            points_per_hour: 2
            show:
              average: false
              extrema: false
              points: hover
            type: 'custom:mini-graph-card'
          - entities:
              - entity: sensor.daily_energy
                name: Diário
              - entity: sensor.monthly_energy
                name: Mensal
              - entity: sensor.monthly_energy_cost
                name: Factura
            show_icon: false
            type: glance
        type: 'custom:vertical-stack-in-card'
      
      - card:
          columns: 3
          state_color: true
          title: Portas/Movimento
          type: glance
        filter:
          exclude:
            - entity_id: binary_sensor.motion_sensor_*_sw
            - state: unavailable
            - entity_id: binary_sensor.wash*_door
            - entity_id: binary_sensor.*_sw
            - entity_id: binary_sensor.*_rf
            - entity_id: binary_sensor.fridge_door
            - entity_id: binary_sensor.*machine*door
          include:
            - entity_id: binary_sensor.*_door
            - entity_id: binary_sensor.motion_sensor_*
            - entity_id: binary_sensor.*browser*
        show_empty: true
        sort:
          ignore_case: true
          method: name
        type: 'custom:auto-entities'
      #- type: map
        #entities:
          #- device_tracker.magnesium
        #hours_to_show: 48
        
      - type: entities
        show_header_toggle: false
        state_color: true
        title: Servidor/Dados
        entities:
          - entity: sensor.omv_disk_raid_data
            name: Disco de Dados (RAID1)
          - entity: sensor.omv_disk_media
            name: Disco de Multimédia
    
      - type: conditional
        conditions:
          - entity: sensor.seventeentrack_has_info
            state: "on"
        card:
          type: 'custom:vertical-stack-in-card'
          title: Tracking de Encomendas
          cards:
            - entities:
                - entity: sensor.seventeentrack_packages_ready_to_be_picked_up
                  name: Pronta a entregar
                - entity: sensor.seventeentrack_packages_in_transit
                  name: Em transito
                - entity: sensor.seventeentrack_packages_not_found
                  name: Não Encontradas
                - entity: sensor.seventeentrack_packages_expired
                  name: Expiradas
              type: entities
            - type: 'custom:auto-entities'
              card:
                show_header_toggle: false
                title: Lista
                type: entities
              filter:
                include:
                  - entity_id: sensor.seventeentrack_package_*
              show_empty: false
              sort:
                ignore_case: true
                method: name
              
        
        
