icon: "mdi:flash"
path: power
title: Power
panel: true
cards:
  - type: "custom:layout-card"
    layout: horizontal
    max_columns: 4
    cards:
      - cards:
          - entity: sensor.bhpzem_power
            max: 3400
            min: 0
            name: Potência
            type: gauge
          - entities:
              - entity: sensor.bhpzem_voltage
              - entity: sensor.bhpzem_current
              - entity: sensor.bhpzem_pf
              - entity: sensor.bhpzem_frequency
            show_icon: false
            type: glance
          - entities:
              - entity: sensor.bhpzem_power
            height: 150
            hours_to_show: 24
            line_width: 1
            name: Últimas 24 Horas
            points_per_hour: 10
            show:
              average: false
              extrema: true
              graph: line
              labels_secondary: false
              points: hover
              state: true
            type: "custom:mini-graph-card"
        title: Potência Instantânea
        type: "custom:vertical-stack-in-card"

      - type: "custom:vertical-stack-in-card"
        cards:
          - type: entities
            title: Facturação
            show_header_toggle: false
            entities:
              - entity: sensor.daily_energy
                name: Consumo Diário
              - entity: sensor.monthly_energy
                name: Facturação Consumo
              - entity: sensor.monthly_energy_cost
                name: Facturação Preço

          - type: entities
            title: Consumos
            entities:
              - type: 'custom:chartjs-card'
                chart: bar
                custom_options:
                  showLegend: false
                data:
                  datasets:
                    - backgroundColor: '${states["sensor.query_daily_energy_current_month"].attributes.colors}'
                      borderWidth: 1
                      data: '${states["sensor.query_daily_energy_current_month"].attributes.data}'
                      label: Eletricidade
                  labels: '${states["sensor.query_daily_energy_current_month"].attributes.labels}'
                entity_row: false
                options:
                  scales:
                    yAxes:
                      - ticks:
                          beginAtZero: true
                  title:
                    display: false
                    text: Consumo Energético Mês Corrente
                    #text: >
                      #${"Consumo energético Mês Corrente -> " +
                      #states["sensor.query_daily_energy_current_month"].attributes.total_eur + "€"}
              
              - type: 'custom:chartjs-card'
                chart: bar
                custom_options:
                  showLegend: false
                data:
                  datasets:
                    - backgroundColor: var(--accent-color)
                      borderWidth: 1
                      data: '${states["sensor.query_daily_energy_current_year"].attributes.data}'
                      label: Eletricidade
                  labels: '${states["sensor.query_daily_energy_current_year"].attributes.labels}'
                entity_row: false
                options:
                  scales:
                    yAxes:
                      - ticks:
                          beginAtZero: true
                  title:
                    display: true
                    text: Consumo energético (últimos 12 meses)
              
                      
                  
              - input_select.energy_daily_graph_select
              - bar_spacing: 1
                entities:
                  - entity: sensor.energy_month_consumption_kw
                    show_graph: false
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_01
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_02
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_03
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_04
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_05
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_06
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_07
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_08
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_09
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_10
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_11
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_12
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_13
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_14
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_15
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_16
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_17
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_18
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_19
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_20
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_21
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_22
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_23
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_24
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_25
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_26
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_27
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_28
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_29
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_30
                  - color: var(--light-primary-color)
                    entity: sensor.energy_kw_day_31
                fixed_value: true
                font_size: 80
                font_size_header: 14px
                group_by: date
                height: 120
                name: Consumo do mês
                show:
                  average: false
                  extrema: false
                  graph: bar
                  icon: false
                  labels: false
                  labels_secondary: false
                  legend: false
                style: |
                  .state__time {
                    display: none;
                  }
                type: "custom:mini-graph-card"
                unit: kW
              - content: >
                  | | | | | | | | | |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 
                  |  |  |  |  |  |  |  |

                  |-|-|-|-|-|-|-|-|-|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|

                  |1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31|
                style: |
                  .markdown {
                    padding: 0px 0px !important;
                  }

                  table {
                    table-layout: fixed;
                    width: 100%;
                    border-spacing: 1.014px 0 !important;
                  }

                  table td:first-child {
                      border-left: 0;
                  }

                  table td:last-child {
                      border-right: 0;
                  }

                  thead {
                    display: none;
                  }

                  td {
                    text-align: center;
                    font-size: 9px;
                  }
                type: "custom:hui-markdown-card"
      
      - type: vertical-stack
        cards:
        - card:
            show_header_toggle: false
            title: Potência Divisões
            type: entities
          filter:
            include:
              - entity_id: sensor.power_sensor_*
          show_empty: false
          sort:
            ignore_case: true
            method: entity_id
          type: "custom:auto-entities"
        - card:
            show_header_toggle: false
            title: Potência Dispositivos
            type: entities
          filter:
            include:
              - entity_id: sensor.power_usage_*
          show_empty: false
          type: "custom:auto-entities"

    

      - type: "custom:vertical-stack-in-card"
        cards:
          - type: entities
            show_header_toggle: false
            title: Electricidade
            entities:
              - entity: sensor.electricity_last_meter
                name: Última Contagem
              - entity: sensor.electricity_meter
                name: Contagem Total
              - entity: input_number.electricity_meter_offpeak
                name: Contagem Vazio
              - entity: input_number.electricity_meter_peak
                name: Contagem Pontas
              - entity: input_number.electricity_meter_full
                name: Contagem Cheias
            
            
          - type: entities
            show_header_toggle: false
            title: Gás
            entities:
              - entity: sensor.gas_last_meter
                name: Última Contagem
              - entity: input_number.gas_meter
                name: Contagem Gás
            
            
          - title: Utilidades
            entities:
              - entity: sensor.water_last_meter
                name: Última Contagem
              - entity: input_number.water_meter
                name: Contagem Água
            show_header_toggle: false
            title: Água
            type: entities
        
      
 
