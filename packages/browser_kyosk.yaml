################################################################################
## Fully kyosk
################################################################################
display:
  - platform: fully_kiosk
    name: TF201 Kyosk
    host: !secret kyosk_ip
    password: !secret kyosk_pass

################################################################################
## Browsers
################################################################################
browser_mod:
  prefix: "browser_"
  devices:
    f6ca877f-817b8345:
      name: Browser TF201 Kyosk
      camera: true

    88005eb9-8aebd3d7:
      name: Browser Magnesium
      disable:
        - light
        - media_player
        - binary_sensor

    caa64a22-4f42ada5:
      name: Browser Pegasus
      disable:
        - light
        - media_player
        - binary_sensor

################################################################################
## Automations
################################################################################
automation old:
  - id: Kyosk Reload on Start
    alias: Kyosk Reload on Start
    trigger:
      - platform: homeassistant
        event: start
    action:
      - service: display.turn_on
        data:
          entity_id: display.tf201_kyosk
      - service: fully_kiosk.load_start_url
        data:
          entity_id: display.tf201_kyosk

  - id: Kyosk Reload Main Page
    alias: Kyosk Reload Main Page
    trigger:
      - platform: state
        entity_id: light.browser_tf201_kyosk
        to: "off"
        for:
          seconds: 30
      - platform: state
        entity_id: light.browser_tf201_kyosk
        to: "unavailable"
        for:
          seconds: 30
    action:
      - service: browser_mod.navigate
        data:
          navigation_path: /lovelace/main
          deviceID:
            - f6ca877f-817b8345

  - id: Kyosk Screen On
    alias: Kyosk Screen On
    trigger:
      - platform: state
        entity_id: binary_sensor.browser_tf201_kyosk
        to: "on"
      - platform: state
        entity_id: binary_sensor.front_door
        to: "on"
      - platform: state
        entity_id: light.hallway
        to: "on"
    action:
      - service: display.turn_on
        data:
          entity_id: display.tf201_kyosk
      - service: homeassistant.turn_on
        data:
          entity_id: light.browser_tf201_kyosk

  - id: Kyosk Screen Off
    alias: Kyosk Screen Off
    trigger:
      - platform: homeassistant
        event: start
      - platform: time_pattern
        minutes: /10
      - platform: state
        entity_id: binary_sensor.browser_tf201_kyosk
        to: "off"
        for:
          seconds: 15
      - platform: state
        entity_id: light.browser_tf201_kyosk
        to: "on"
        for:
          seconds: 20
      - platform: state
        entity_id: light.hallway
        to: "off"
      - platform: state
        entity_id: display.tf201_kyosk
        to: "on"
        for:
          seconds: 20
    condition:
      - condition: state
        entity_id: binary_sensor.browser_tf201_kyosk
        state: "off"
    action:
      - service: display.turn_off
        data:
          entity_id: display.tf201_kyosk
      - service: homeassistant.turn_off
        data:
          entity_id: light.browser_tf201_kyosk
