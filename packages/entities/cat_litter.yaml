homeassistant:
  customize:
    counter.cat_litter_box_visits:
      friendly_name: Litter Box Visits

binary_sensor:
  - platform: mqtt
    name: "Litter Box Motion"
    device_class: occupancy
    state_topic: "binary_rf_sensors/litter_box_motion"
    qos: 1

counter:
  cat_litter_box_visits:
    step: 1
    icon: "mdi:cat"

input_datetime:
  cat_litter_box_last_visit:
    name: Litter Box Last Visit
    icon: mdi:clock-outline
    has_date: true
    has_time: true

sensor:
  - platform: template
    sensors:
      cat_litter_box_last_visit:
        friendly_name: "Litter Box Last Visit"
        device_class: timestamp
        value_template: >
          {{ state_attr('input_datetime.cat_litter_box_last_visit', 'timestamp') | timestamp_custom("%Y-%m-%d %H:%M:%S", true) }}

#automation old:
#- alias: Reset PIR State Cat Litter
  #initial_state: true
  #trigger:
    #- platform: homeassistant
      #event: start
    #- platform: state
      #entity_id: binary_sensor.litter_box_motion
      #from: "off"
      #to: "on"
      #for:
        #seconds: 120
  #action:
    #- service: mqtt.publish
      #data:
        #topic: binary_rf_sensors/litter_box_motion
        #payload: "OFF"

#- id: Cat Litter Mark Visit
  #alias: Cat Litter Mark Visit
  #initial_state: true
  #trigger:
  #- entity_id: binary_sensor.litter_box_motion
    #from: 'off'
    #platform: state
    #to: 'on'
  #action:
  #- service: counter.increment
    #data:
      #entity_id: counter.cat_litter_box_visits
  #- service: input_datetime.set_datetime
    #data_template:
      #entity_id: input_datetime.cat_litter_box_last_visit
      #date: '{{ now().timestamp() | timestamp_custom("%Y-%m-%d", true) }}'
      #time: '{{ now().timestamp() | timestamp_custom("%H:%M:%S", true) }}'
