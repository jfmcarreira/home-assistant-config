switch:
  - platform: template
    switches:
      motion_based_lights:
        friendly_name: Luzes Automáticas
        value_template: "{{ is_state('input_boolean.automation_sw_all_motion_lights', 'on') }}"
        turn_on:
          - service: input_boolean.turn_on
            entity_id: input_boolean.automation_sw_all_motion_lights
        turn_off:
          service: script.lights_disable_motion_lights

script:
  lights_disable_motion_lights:
    alias: Desligar Luzes Automáticas Temporáriamente
    variables:
      automation_appdaemon_motion_lights_state: "{{ states.input_boolean.automation_sw_all_motion_lights.state }}"
    sequence:
      - service: input_boolean.turn_off
        entity_id: input_boolean.automation_sw_all_motion_lights
      - service: light.turn_off
        entity_id: light.hallway_presence_group
      - service: light.turn_off
        entity_id: light.office_desk
      - service: light.turn_off
        entity_id: light.living_room_tv_leds

      - delay: 00:30:00

      - service: >
          {% if automation_appdaemon_motion_lights_state == 'on' %}
              input_boolean.turn_on
          {% else %}
              input_boolean.turn_off
          {% endif %}
        entity_id: input_boolean.automation_sw_all_motion_lights
