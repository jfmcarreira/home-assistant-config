input_boolean:
  automation_appdaemon_motion_lights_living_room:
    name: Ativar Luz de Presença da Sala
    icon: mdi:light
  automation_appdaemon_motion_lights_office:
    name: Ativar Luz de Presença do Escritório
    icon: mdi:light
  automation_appdaemon_motion_lights_hallway:
    name: Ativar Luz de Presença do Corredor
    icon: mdi:light
  automation_sw_all_motion_lights:
    name: Controlador das Luzes Automáticas
    icon: mdi:light

    
switch:
  - platform: template
    switches:
      hallway_office_motion_lights:
        friendly_name: Luzes Automáticas 
        value_template: "{{ is_state('input_boolean.automation_appdaemon_motion_lights_office', 'on') or is_state('input_boolean.automation_appdaemon_motion_lights_hallway', 'on') }}"
        turn_on:
          - service: input_boolean.turn_on
            entity_id: input_boolean.automation_appdaemon_motion_lights_hallway
          - service: input_boolean.turn_on
            entity_id: input_boolean.automation_appdaemon_motion_lights_office
        turn_off:
          service: script.lights_disable_motion_light_hallway
            
script:
  lights_disable_motion_light_hallway:
    alias: Desligar Luzes Automáticas do Corredor
    variables:
      automation_appdaemon_motion_lights_hallway_state: "{{ states.input_boolean.automation_appdaemon_motion_lights_hallway.state }}"
      automation_appdaemon_motion_lights_office_state: "{{ states.input_boolean.automation_appdaemon_motion_lights_office.state }}"
    sequence:
      - service: input_boolean.turn_off
        entity_id: input_boolean.automation_appdaemon_motion_lights_hallway
      - service: input_boolean.turn_off
        entity_id: input_boolean.automation_appdaemon_motion_lights_office
      - service: light.turn_off
        entity_id: light.hallway
      - service: light.turn_off
        entity_id: light.hallway_mirror
      - service: light.turn_off
        entity_id: light.hallway_presence
      - service: light.turn_off
        entity_id: light.office_desk
        
      - delay: 00:30:00
      
      - service: >
          {% if automation_appdaemon_motion_lights_hallway_state == 'on' %}
              input_boolean.turn_on
          {% else %}
              input_boolean.turn_off
          {% endif %}
        entity_id: input_boolean.automation_appdaemon_motion_lights_hallway
      - service: >
          {% if automation_appdaemon_motion_lights_hallway_state == 'on' %}
              input_boolean.turn_on
          {% else %}
              input_boolean.turn_off
          {% endif %}
        entity_id: input_boolean.automation_appdaemon_motion_lights_office
