# - trigger:
#     - platform: homeassistant
#       event: start
#     - platform: state
#       entity_id: input_boolean.house_guest
#     - platform: state
#       entity_id: person.joao
- binary_sensor:
    - name: Joao Home
      unique_id: joao_home
      state: "{{ not is_state('person.joao', 'not_home' ) }}"
      attributes:
        Mudou de Localização: "{{ now() }}"
# - trigger:
#     - platform: homeassistant
#       event: start
#     - platform: state
#       entity_id: input_boolean.house_guest
#     - platform: state
#        entity_id: person.bianca
- binary_sensor:
    - name: Bianca Home
      unique_id: bianca_home
      state: "{{ not ( states.person.bianca.state == 'not_home' ) }}"
      attributes:
        Mudou de Localização: "{{ now() }}"
- binary_sensor:
    - name: Notify Home
      unique_id: notify_home
      icon: "mdi:home"
      state: >
        {{ is_state('input_boolean.house_guest', 'on') or
            is_state('binary_sensor.joao_home', 'on') or 
            is_state('binary_sensor.bianca_home', 'on') 
        }}

- sensor:
    # - name: Joao State
    #   unique_id: joao_state
    #   state: >-
    #     {% if is_state('binary_sensor.imac_soundparticles_camera', 'on') %}
    #         {{ "On Call" }}
    #     {% elif is_state('person.joao', 'home') %}
    #         {% if now().strftime("%H")|int < 19 and now().strftime("%H")|int > 9 and is_state('binary_sensor.imac_soundparticles_active', 'on') %}
    #             {{ "Trabalhar" }}
    #         {% else %}
    #             {% if is_state('sensor.amazfit_joao', 'not_home') %}
    #                 {{ "Em Casa" }}
    #             {% else %}
    #                 {{ states.device_tracker.joao_amazfit.state }}
    #             {% endif %}
    #         {% endif %}
    #     {% elif is_state('person.joao', 'not_home') %}
    #         {{ "Fora" }}
    #     {% else %}
    #         {{ states('person.joao') }}
    #     {% endif %}

    - name: Joao State
      unique_id: joao_state
      state: >-
        {% if is_state('person.joao', 'home') %}
            {% if is_state('sensor.amazfit_joao', 'not_home') %}
                {{ "Em Casa" }}
            {% else %}
                {{ states.device_tracker.joao_amazfit.state }}
            {% endif %}
        {% elif is_state('person.joao', 'not_home') %}
            {{ "Fora" }}
        {% else %}
            {{ states('person.joao') }}
        {% endif %}

    - name: Bianca State
      unique_id: bianca_state
      state: >-
        {% if is_state('person.bianca', 'home') %}
            {% if is_state('sensor.amazfit_bianca', 'not_home') %}
                {{ "Em Casa" }}
            {% else %}
                {{ states.device_tracker.bianca_amazfit.state }}
            {% endif %}
        {% elif is_state('person.bianca', 'not_home') %}
            {{ "Fora" }}
        {% else %}
            {{ states('person.bianca') }}
        {% endif %}
